<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Gallery of reproducible examples | Data Integration, Manipulation and Visualization of Phylogenetic Trees</title>
  <meta name="description" content="Chapter 13 Gallery of reproducible examples | Data Integration, Manipulation and Visualization of Phylogenetic Trees" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Gallery of reproducible examples | Data Integration, Manipulation and Visualization of Phylogenetic Trees" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Gallery of reproducible examples | Data Integration, Manipulation and Visualization of Phylogenetic Trees" />
  
  
  



<meta name="date" content="2020-09-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter12.html"/>
<link rel="next" href="faq.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/pathseg-1.0.2/pathseg.js"></script>
<script src="libs/comic-0.961/comic.min.js"></script>
<script src="libs/comicR-binding-0.2/comicR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>üìñ Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>üéØ Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>üìù Citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-structure"><i class="fa fa-check"></i>üìö Book structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#want-to-help"><i class="fa fa-check"></i>üíñ Want to help?</a></li>
</ul></li>
<li class="part"><span><b>Part I: Tree data input, output and manipulation</b></span></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Importing Tree with Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#pc"><i class="fa fa-check"></i><b>1.1</b> Overview of Phylogenetic Tree Construction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#format"><i class="fa fa-check"></i><b>1.2</b> Phylogenetic Tree Formats</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#newick-tree-format"><i class="fa fa-check"></i><b>1.2.1</b> Newick tree format</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#nexus-tree-format"><i class="fa fa-check"></i><b>1.2.2</b> NEXUS tree format</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapter1.html"><a href="chapter1.html#nhxtext"><i class="fa fa-check"></i><b>1.2.3</b> New Hampshire eXtended format</a></li>
<li class="chapter" data-level="1.2.4" data-path="chapter1.html"><a href="chapter1.html#jplace-format"><i class="fa fa-check"></i><b>1.2.4</b> Jplace format</a></li>
<li class="chapter" data-level="1.2.5" data-path="chapter1.html"><a href="chapter1.html#software-outputs"><i class="fa fa-check"></i><b>1.2.5</b> Software outputs</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#getting-tree-data-with-treeio"><i class="fa fa-check"></i><b>1.3</b> Getting Tree Data with <em>treeio</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chapter1.html"><a href="chapter1.html#overview-of-treeio"><i class="fa fa-check"></i><b>1.3.1</b> Overview of <em>treeio</em></a></li>
<li class="chapter" data-level="1.3.2" data-path="chapter1.html"><a href="chapter1.html#function-demonstration"><i class="fa fa-check"></i><b>1.3.2</b> Function Demonstration</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapter1.html"><a href="chapter1.html#as-treedata"><i class="fa fa-check"></i><b>1.3.3</b> Converting other tree-like object to <code>phylo</code> or <code>treedata</code> object</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapter1.html"><a href="chapter1.html#get-treedata-data"><i class="fa fa-check"></i><b>1.3.4</b> Getting information from <code>treedata</code> object</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#summary1"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Manipulating Tree with Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#tidytree"><i class="fa fa-check"></i><b>2.1</b> Manipulating tree data using tidy interface</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#the-phylo-object"><i class="fa fa-check"></i><b>2.1.1</b> The <code>phylo</code> object</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#the-treedata-object"><i class="fa fa-check"></i><b>2.1.2</b> The <code>treedata</code> object</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#accesor-tidytree"><i class="fa fa-check"></i><b>2.1.3</b> Access related nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#data-integration"><i class="fa fa-check"></i><b>2.2</b> Data Integration</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#merge-tree"><i class="fa fa-check"></i><b>2.2.1</b> Combining tree data</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter2.html"><a href="chapter2.html#link-external-data"><i class="fa fa-check"></i><b>2.2.2</b> Linking external data to phylogeny</a></li>
<li class="chapter" data-level="2.2.3" data-path="chapter2.html"><a href="chapter2.html#grouping-taxa"><i class="fa fa-check"></i><b>2.2.3</b> Grouping taxa</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#reroot-treeio"><i class="fa fa-check"></i><b>2.3</b> Rerooting tree</a></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#rescale-treeio"><i class="fa fa-check"></i><b>2.4</b> Rescaling Tree Branches</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#subsetting-tree-with-data"><i class="fa fa-check"></i><b>2.5</b> Subsetting Tree with Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="chapter2.html"><a href="chapter2.html#remove-tip"><i class="fa fa-check"></i><b>2.5.1</b> Removing tips in a phylogenetic tree</a></li>
<li class="chapter" data-level="2.5.2" data-path="chapter2.html"><a href="chapter2.html#subset-tip"><i class="fa fa-check"></i><b>2.5.2</b> Subsetting tree by tip label</a></li>
<li class="chapter" data-level="2.5.3" data-path="chapter2.html"><a href="chapter2.html#subset-node"><i class="fa fa-check"></i><b>2.5.3</b> Subsetting tree by internal node number</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#ggtree-fortify"><i class="fa fa-check"></i><b>2.6</b> Manipulating tree data for visualization</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#summary2"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Exporting tree with data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#exporting-tree-data-to-beast-nexus-format"><i class="fa fa-check"></i><b>3.2</b> Exporting Tree Data to <em>BEAST</em> Nexus Format</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#exportingconverting-software-output"><i class="fa fa-check"></i><b>3.2.1</b> Exporting/converting software output</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter3.html"><a href="chapter3.html#combining-tree-with-external-data"><i class="fa fa-check"></i><b>3.2.2</b> Combining tree with external data</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter3.html"><a href="chapter3.html#merging-tree-data-from-different-sources"><i class="fa fa-check"></i><b>3.2.3</b> Merging tree data from different sources</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#write-jtree"><i class="fa fa-check"></i><b>3.3</b> Exporting Tree Data to <em>jtree</em> Format</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#summary3"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>Part II: Tree data visualization and annotation</b></span></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> Phylogenetic Tree Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#visualizing-phylogenetic-tree-with-ggtree"><i class="fa fa-check"></i><b>4.2</b> Visualizing Phylogenetic Tree with <em>ggtree</em></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chapter4.html"><a href="chapter4.html#basic-tree-visualization"><i class="fa fa-check"></i><b>4.2.1</b> Basic Tree Visualization</a></li>
<li class="chapter" data-level="4.2.2" data-path="chapter4.html"><a href="chapter4.html#tree-layouts"><i class="fa fa-check"></i><b>4.2.2</b> Layouts of phylogenetic tree</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#displaying-tree-components"><i class="fa fa-check"></i><b>4.3</b> Displaying Tree Components</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter4.html"><a href="chapter4.html#geom-trescale"><i class="fa fa-check"></i><b>4.3.1</b> Displaying tree scale (evolution distance)</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter4.html"><a href="chapter4.html#geom-nodepoint"><i class="fa fa-check"></i><b>4.3.2</b> Displaying nodes/tips</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter4.html"><a href="chapter4.html#displaying-labels"><i class="fa fa-check"></i><b>4.3.3</b> Displaying labels</a></li>
<li class="chapter" data-level="4.3.4" data-path="chapter4.html"><a href="chapter4.html#displaying-root-edge"><i class="fa fa-check"></i><b>4.3.4</b> Displaying root edge</a></li>
<li class="chapter" data-level="4.3.5" data-path="chapter4.html"><a href="chapter4.html#color-tree"><i class="fa fa-check"></i><b>4.3.5</b> Color tree</a></li>
<li class="chapter" data-level="4.3.6" data-path="chapter4.html"><a href="chapter4.html#rescale-tree"><i class="fa fa-check"></i><b>4.3.6</b> Rescale tree</a></li>
<li class="chapter" data-level="4.3.7" data-path="chapter4.html"><a href="chapter4.html#modify-compenents-of-a-theme"><i class="fa fa-check"></i><b>4.3.7</b> Modify compenents of a theme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#visualize-a-list-of-trees"><i class="fa fa-check"></i><b>4.4</b> Visualize a list of trees</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#summary4"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Phylogenetic Tree Annotation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#visualizing-and-annotating-tree-using-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1</b> Visualizing and Annotating Tree using Grammar of Graphics</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#layers-for-tree-annotation"><i class="fa fa-check"></i><b>5.2</b> Layers for Tree Annotation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter5.html"><a href="chapter5.html#colored-strips"><i class="fa fa-check"></i><b>5.2.1</b> Colored strips</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter5.html"><a href="chapter5.html#highlight-clades"><i class="fa fa-check"></i><b>5.2.2</b> Highlight clades</a></li>
<li class="chapter" data-level="5.2.3" data-path="chapter5.html"><a href="chapter5.html#taxa-connection"><i class="fa fa-check"></i><b>5.2.3</b> Taxa connection</a></li>
<li class="chapter" data-level="5.2.4" data-path="chapter5.html"><a href="chapter5.html#uncertainty-of-evolutionary-inference"><i class="fa fa-check"></i><b>5.2.4</b> Uncertainty of evolutionary inference</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#tree-annotation-with-output-from-evolution-software"><i class="fa fa-check"></i><b>5.3</b> Tree annotation with output from evolution software</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#tree-annotation-using-data-from-evolutionary-analysis-software"><i class="fa fa-check"></i><b>5.3.1</b> Tree annotation using data from evolutionary analysis software</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#summary5"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Visual Exploration of Phylogenetic Tree</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#viewing-selected-clade"><i class="fa fa-check"></i><b>6.1</b> Viewing Selected Clade</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#scale-clade"><i class="fa fa-check"></i><b>6.2</b> Scaling Selected Clade</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#collapsing-and-expanding-clade"><i class="fa fa-check"></i><b>6.3</b> Collapsing and Expanding Clade</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#group-taxa-vis"><i class="fa fa-check"></i><b>6.4</b> Grouping Taxa</a></li>
<li class="chapter" data-level="6.5" data-path="chapter6.html"><a href="chapter6.html#exploring-tree-structure"><i class="fa fa-check"></i><b>6.5</b> Exploring tree structure</a></li>
<li class="chapter" data-level="6.6" data-path="chapter6.html"><a href="chapter6.html#summary6"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Plotting tree with data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#attach-operator"><i class="fa fa-check"></i><b>7.1</b> Mapping data to the tree structure</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#facet_plot"><i class="fa fa-check"></i><b>7.2</b> Aligning graph to the tree based on tree structure</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#gheatmap"><i class="fa fa-check"></i><b>7.3</b> Visualize tree with associated matrix</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter7.html"><a href="chapter7.html#gheatmap-ggnewscale"><i class="fa fa-check"></i><b>7.3.1</b> Visualize tree with multiple associated matrix</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#msaplot"><i class="fa fa-check"></i><b>7.4</b> Visualize tree with multiple sequence alignment</a></li>
<li class="chapter" data-level="7.5" data-path="chapter7.html"><a href="chapter7.html#composite_plot"><i class="fa fa-check"></i><b>7.5</b> Composite plots</a></li>
<li class="chapter" data-level="7.6" data-path="chapter7.html"><a href="chapter7.html#ggtree_object"><i class="fa fa-check"></i><b>7.6</b> The <code>ggtree</code> object</a></li>
<li class="chapter" data-level="7.7" data-path="chapter7.html"><a href="chapter7.html#summary7"><i class="fa fa-check"></i><b>7.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> Annotating Tree with Silhouette Images and Sub-plots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#ggimage"><i class="fa fa-check"></i><b>8.1</b> Annotating Tree with Images</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#phylopic"><i class="fa fa-check"></i><b>8.2</b> Annotating Tree with Phylopic</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#subplots"><i class="fa fa-check"></i><b>8.3</b> Annotating Tree with Sub-plots</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter8.html"><a href="chapter8.html#annotate-with-bar-charts"><i class="fa fa-check"></i><b>8.3.1</b> Annotate with bar charts</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapter8.html"><a href="chapter8.html#annotate-with-pie-charts"><i class="fa fa-check"></i><b>8.3.2</b> Annotate with pie charts</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapter8.html"><a href="chapter8.html#annotate-with-other-types-of-charts"><i class="fa fa-check"></i><b>8.3.3</b> Annotate with other types of charts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter8.html"><a href="chapter8.html#phylomoji"><i class="fa fa-check"></i><b>8.4</b> Have Fun with Phylomoji</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chapter8.html"><a href="chapter8.html#emoji-in-circularfan-layout-tree"><i class="fa fa-check"></i><b>8.4.1</b> Emoji in circular/fan layout tree</a></li>
<li class="chapter" data-level="8.4.2" data-path="chapter8.html"><a href="chapter8.html#emoji-to-label-clades"><i class="fa fa-check"></i><b>8.4.2</b> Emoji to label clades</a></li>
<li class="chapter" data-level="8.4.3" data-path="chapter8.html"><a href="chapter8.html#apple-color-emoji"><i class="fa fa-check"></i><b>8.4.3</b> Apple Color Emoji</a></li>
<li class="chapter" data-level="8.4.4" data-path="chapter8.html"><a href="chapter8.html#phylomoji-in-ascii-art"><i class="fa fa-check"></i><b>8.4.4</b> Phylomoji in ASCII art</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> ggtree for other tree-like objects</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#ggtree-for-phylogenetic-tree-objects"><i class="fa fa-check"></i><b>9.1</b> ggtree for phylogenetic tree objects</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter9.html"><a href="chapter9.html#phylobase"><i class="fa fa-check"></i><b>9.1.1</b> The phylo4 and phylo4d objects</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapter9.html"><a href="chapter9.html#phylog"><i class="fa fa-check"></i><b>9.1.2</b> The phylog object</a></li>
<li class="chapter" data-level="9.1.3" data-path="chapter9.html"><a href="chapter9.html#phyloseq"><i class="fa fa-check"></i><b>9.1.3</b> The phyloseq object</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#dendrogram"><i class="fa fa-check"></i><b>9.2</b> ggtree for dendrograms</a></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#igraph"><i class="fa fa-check"></i><b>9.3</b> ggtree for tree graph</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#ggtree-for-other-tree-like-structure"><i class="fa fa-check"></i><b>9.4</b> ggtree for other tree-like structure</a></li>
</ul></li>
<li class="part"><span><b>Part III: ggtree extensions</b></span></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> ggtreeExtra</a>
<ul>
<li class="chapter" data-level="10.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#aligning-graphs-to-the-tree-based-on-tree-structure"><i class="fa fa-check"></i><b>10.2</b> Aligning graphs to the tree based on tree structure</a></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#aligning-multiple-graphs-to-the-tree-for-multi-dimensional-data"><i class="fa fa-check"></i><b>10.3</b> Aligning multiple graphs to the tree for multi-dimensional data</a></li>
<li class="chapter" data-level="10.4" data-path="chapter10.html"><a href="chapter10.html#api-to-link-ggtree-and-ggplot2."><i class="fa fa-check"></i><b>10.4</b> API to link <em>ggtree</em> and <em>ggplot2</em>.</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>11</b> Other ggtree extensions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter11.html"><a href="chapter11.html#MicrobiotaProcess"><i class="fa fa-check"></i><b>11.1</b> Taxonomy annotation using MicrobiotaProcess</a></li>
</ul></li>
<li class="part"><span><b>Part IV: Miscellaneous topics</b></span></li>
<li class="chapter" data-level="12" data-path="chapter12.html"><a href="chapter12.html"><i class="fa fa-check"></i><b>12</b> ggtree utilities</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter12.html"><a href="chapter12.html#facet-utils"><i class="fa fa-check"></i><b>12.1</b> Facet utilities</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="chapter12.html"><a href="chapter12.html#facet_widths"><i class="fa fa-check"></i><b>12.1.1</b> facet_widths</a></li>
<li class="chapter" data-level="12.1.2" data-path="chapter12.html"><a href="chapter12.html#facet_labeller"><i class="fa fa-check"></i><b>12.1.2</b> facet_labeller</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="chapter12.html"><a href="chapter12.html#geom2"><i class="fa fa-check"></i><b>12.2</b> Geometric layers</a></li>
<li class="chapter" data-level="12.3" data-path="chapter12.html"><a href="chapter12.html#layout-utilities"><i class="fa fa-check"></i><b>12.3</b> Layout utilities</a></li>
<li class="chapter" data-level="12.4" data-path="chapter12.html"><a href="chapter12.html#scale-utilities"><i class="fa fa-check"></i><b>12.4</b> Scale utilities</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="chapter12.html"><a href="chapter12.html#xlim_expand"><i class="fa fa-check"></i><b>12.4.1</b> xlim_expand</a></li>
<li class="chapter" data-level="12.4.2" data-path="chapter12.html"><a href="chapter12.html#hexpand"><i class="fa fa-check"></i><b>12.4.2</b> hexpand</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="chapter12.html"><a href="chapter12.html#tree-utilities"><i class="fa fa-check"></i><b>12.5</b> Tree utilities</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="chapter12.html"><a href="chapter12.html#tiporder"><i class="fa fa-check"></i><b>12.5.1</b> Extract tip order</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapter13.html"><a href="chapter13.html"><i class="fa fa-check"></i><b>13</b> Gallery of reproducible examples</a>
<ul>
<li class="chapter" data-level="13.1" data-path="chapter13.html"><a href="chapter13.html#hpv58"><i class="fa fa-check"></i><b>13.1</b> Visualizing pairwise nucleotide sequence distance with phylogenetic tree</a></li>
<li class="chapter" data-level="13.2" data-path="chapter13.html"><a href="chapter13.html#symbolic-bootstrap"><i class="fa fa-check"></i><b>13.2</b> Displaying different symbolic points for bootstrap values.</a></li>
<li class="chapter" data-level="13.3" data-path="chapter13.html"><a href="chapter13.html#phylo-grouping"><i class="fa fa-check"></i><b>13.3</b> Highlighting different groups.</a></li>
<li class="chapter" data-level="13.4" data-path="chapter13.html"><a href="chapter13.html#genome-locus"><i class="fa fa-check"></i><b>13.4</b> Phylogenetic tree with genome locus structure</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently asked questions</a>
<ul>
<li class="chapter" data-level="A.1" data-path="faq.html"><a href="faq.html#installation"><i class="fa fa-check"></i><b>A.1</b> Installation</a></li>
<li class="chapter" data-level="A.2" data-path="faq.html"><a href="faq.html#faq-r"><i class="fa fa-check"></i><b>A.2</b> Basic R related</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="faq.html"><a href="faq.html#faq-local-file"><i class="fa fa-check"></i><b>A.2.1</b> Use your local file</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="faq.html"><a href="faq.html#faq-aes-mapping"><i class="fa fa-check"></i><b>A.3</b> Aesthetic mapping</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="faq.html"><a href="faq.html#faq-inherit-aes"><i class="fa fa-check"></i><b>A.3.1</b> Inherit <em>aes</em></a></li>
<li class="chapter" data-level="A.3.2" data-path="faq.html"><a href="faq.html#faq-dollar-aes"><i class="fa fa-check"></i><b>A.3.2</b> Never use <code>$</code> in aes</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="faq.html"><a href="faq.html#faq-text"><i class="fa fa-check"></i><b>A.4</b> Text &amp; Label</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="faq.html"><a href="faq.html#faq-label-truncated"><i class="fa fa-check"></i><b>A.4.1</b> Tip label truncated</a></li>
<li class="chapter" data-level="A.4.2" data-path="faq.html"><a href="faq.html#faq-modify-label"><i class="fa fa-check"></i><b>A.4.2</b> Modify (tip) labels</a></li>
<li class="chapter" data-level="A.4.3" data-path="faq.html"><a href="faq.html#faq-formatting-label"><i class="fa fa-check"></i><b>A.4.3</b> Formatting (tip) labels</a></li>
<li class="chapter" data-level="A.4.4" data-path="faq.html"><a href="faq.html#faq-ggrepel"><i class="fa fa-check"></i><b>A.4.4</b> Avoid overlapping text labels</a></li>
<li class="chapter" data-level="A.4.5" data-path="faq.html"><a href="faq.html#faq-bootstrap"><i class="fa fa-check"></i><b>A.4.5</b> Bootstrap values from newick format</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="faq.html"><a href="faq.html#branch-setting"><i class="fa fa-check"></i><b>A.5</b> Branch setting</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="faq.html"><a href="faq.html#change-branch-length-of-outgroup"><i class="fa fa-check"></i><b>A.5.1</b> Change branch length of outgroup</a></li>
<li class="chapter" data-level="A.5.2" data-path="faq.html"><a href="faq.html#bind-tip"><i class="fa fa-check"></i><b>A.5.2</b> Attach a new tip to a tree</a></li>
<li class="chapter" data-level="A.5.3" data-path="faq.html"><a href="faq.html#change-colours-or-line-types-of-arbitrary-selected-branches"><i class="fa fa-check"></i><b>A.5.3</b> Change colours or line types of arbitrary selected branches</a></li>
<li class="chapter" data-level="A.5.4" data-path="faq.html"><a href="faq.html#arbitrary-point"><i class="fa fa-check"></i><b>A.5.4</b> Add an arbitrary point to a branch</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="faq.html"><a href="faq.html#different-x-axis-labels-for-different-facet-panels"><i class="fa fa-check"></i><b>A.6</b> Different x-axis labels for different facet panels</a></li>
<li class="chapter" data-level="A.7" data-path="faq.html"><a href="faq.html#faq-under-the-tree"><i class="fa fa-check"></i><b>A.7</b> Plot something behind the phylogeny</a></li>
<li class="chapter" data-level="A.8" data-path="faq.html"><a href="faq.html#faq-enlarge-center-space"><i class="fa fa-check"></i><b>A.8</b> Enlarge center space in circular/fan layout tree</a></li>
<li class="chapter" data-level="A.9" data-path="faq.html"><a href="faq.html#use-the-most-distant-tip-from-the-root-as-the-origin-of-the-time-scale"><i class="fa fa-check"></i><b>A.9</b> Use the most distant tip from the root as the origin of the time scale</a></li>
<li class="chapter" data-level="A.10" data-path="faq.html"><a href="faq.html#export-edit"><i class="fa fa-check"></i><b>A.10</b> Edit tree graphic details</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="related-tools.html"><a href="related-tools.html"><i class="fa fa-check"></i><b>B</b> Related tools</a>
<ul>
<li class="chapter" data-level="B.1" data-path="related-tools.html"><a href="related-tools.html#rtol"><i class="fa fa-check"></i><b>B.1</b> rtol: An R interface to Open Tree API</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="ggimage-tips.html"><a href="ggimage-tips.html"><i class="fa fa-check"></i><b>C</b> Tips for using <code>ggtree</code> with <code>ggimage</code></a>
<ul>
<li class="chapter" data-level="C.1" data-path="ggimage-tips.html"><a href="ggimage-tips.html#ggimage-rm-image-bg"><i class="fa fa-check"></i><b>C.1</b> Example 1: Remove background of images</a></li>
<li class="chapter" data-level="C.2" data-path="ggimage-tips.html"><a href="ggimage-tips.html#ggimage-bgimage"><i class="fa fa-check"></i><b>C.2</b> Example 2: Plot tree on a background image</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="commicR.html"><a href="commicR.html"><i class="fa fa-check"></i><b>D</b> Comic (xkcd-like) phylogenetic tree</a></li>
<li class="chapter" data-level="E" data-path="ascii-tree.html"><a href="ascii-tree.html"><i class="fa fa-check"></i><b>E</b> Print ASCII-art rooted tree</a></li>
<li class="chapter" data-level="F" data-path="facet-zoom.html"><a href="facet-zoom.html"><i class="fa fa-check"></i><b>F</b> Zoom in selected portion</a></li>
<li class="chapter" data-level="G" data-path="run-ggtree-in-jupyter-notebook.html"><a href="run-ggtree-in-jupyter-notebook.html"><i class="fa fa-check"></i><b>G</b> Run ggtree in Jupyter notebook</a></li>
<li class="chapter" data-level="H" data-path="figures-and-tables.html"><a href="figures-and-tables.html"><i class="fa fa-check"></i><b>H</b> Figures and Tables</a></li>
<li class="chapter" data-level="I" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>I</b> Session Info</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Integration, Manipulation and Visualization of Phylogenetic Trees</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter13" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Gallery of reproducible examples</h1>
<div id="hpv58" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Visualizing pairwise nucleotide sequence distance with phylogenetic tree</h2>
<p>This example reproduces Fig. 1 of <span class="citation">(Chen et al. <a href="#ref-chen_ancient_2017" role="doc-biblioref">2017</a>)</span>. It extracts accession numbers from tip labels of the HPV58 tree and calculates pairwise nucleotide sequence distances. The distance matrix is visualized as dot and line plots. This example demonstrates the abilities of adding multiple layers to a specific panel. As illustrated on Figure <a href="chapter13.html#fig:jv2017">13.1</a>, the <code>facet_plot</code> function displays sequence distances as a dot plot and then adds a layer of line plot to the same panel, <em>i.e.</em> Sequence Distance. In addition, the tree in <code>facet_plot</code> can be fully annotated with multiple layers (clade labels, bootstrap support values, <em>etc</em>). The source code of this example was firstly published in Supplemental File of <span class="citation">(Yu et al. <a href="#ref-yu_two_2018" role="doc-biblioref">2018</a>)</span>.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="chapter13.html#cb244-1" aria-hidden="true"></a><span class="kw">library</span>(tibble)</span>
<span id="cb244-2"><a href="chapter13.html#cb244-2" aria-hidden="true"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb244-3"><a href="chapter13.html#cb244-3" aria-hidden="true"></a><span class="kw">library</span>(Biostrings)</span>
<span id="cb244-4"><a href="chapter13.html#cb244-4" aria-hidden="true"></a><span class="kw">library</span>(treeio)</span>
<span id="cb244-5"><a href="chapter13.html#cb244-5" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb244-6"><a href="chapter13.html#cb244-6" aria-hidden="true"></a><span class="kw">library</span>(ggtree)</span>
<span id="cb244-7"><a href="chapter13.html#cb244-7" aria-hidden="true"></a></span>
<span id="cb244-8"><a href="chapter13.html#cb244-8" aria-hidden="true"></a>tree &lt;-<span class="st"> </span><span class="kw">read.tree</span>(<span class="st">&quot;data/HPV58.tree&quot;</span>)</span>
<span id="cb244-9"><a href="chapter13.html#cb244-9" aria-hidden="true"></a></span>
<span id="cb244-10"><a href="chapter13.html#cb244-10" aria-hidden="true"></a>clade &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">A3 =</span> <span class="dv">92</span>, <span class="dt">A1 =</span> <span class="dv">94</span>, <span class="dt">A2 =</span> <span class="dv">108</span>, <span class="dt">B1 =</span> <span class="dv">156</span>, <span class="dt">B2 =</span> <span class="dv">159</span>, <span class="dt">C =</span> <span class="dv">163</span>, <span class="dt">D1 =</span> <span class="dv">173</span>, <span class="dt">D2 =</span> <span class="dv">176</span>)</span>
<span id="cb244-11"><a href="chapter13.html#cb244-11" aria-hidden="true"></a>tree &lt;-<span class="st"> </span><span class="kw">groupClade</span>(tree, clade)</span>
<span id="cb244-12"><a href="chapter13.html#cb244-12" aria-hidden="true"></a>cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">A1 =</span> <span class="st">&quot;#EC762F&quot;</span>, <span class="dt">A2 =</span> <span class="st">&quot;#CA6629&quot;</span>, <span class="dt">A3 =</span> <span class="st">&quot;#894418&quot;</span>, <span class="dt">B1 =</span> <span class="st">&quot;#0923FA&quot;</span>, </span>
<span id="cb244-13"><a href="chapter13.html#cb244-13" aria-hidden="true"></a>         <span class="dt">B2 =</span> <span class="st">&quot;#020D87&quot;</span>, <span class="dt">C =</span> <span class="st">&quot;#000000&quot;</span>, <span class="dt">D1 =</span> <span class="st">&quot;#9ACD32&quot;</span>,<span class="dt">D2 =</span> <span class="st">&quot;#08630A&quot;</span>)</span>
<span id="cb244-14"><a href="chapter13.html#cb244-14" aria-hidden="true"></a></span>
<span id="cb244-15"><a href="chapter13.html#cb244-15" aria-hidden="true"></a><span class="co">## visualize the tree with tip labels and tree scale</span></span>
<span id="cb244-16"><a href="chapter13.html#cb244-16" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">ggtree</span>(tree, <span class="kw">aes</span>(<span class="dt">color =</span> group), <span class="dt">ladderize =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rotate</span>(<span class="kw">rootnode</span>(tree)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb244-17"><a href="chapter13.html#cb244-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_tiplab</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;italic(&#39;&quot;</span>, label, <span class="st">&quot;&#39;)&quot;</span>)), <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span></span>
<span id="cb244-18"><a href="chapter13.html#cb244-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_treescale</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">width =</span> <span class="fl">0.002</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb244-19"><a href="chapter13.html#cb244-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(cols, <span class="st">&quot;black&quot;</span>), <span class="dt">na.value =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;Lineage&quot;</span>,</span>
<span id="cb244-20"><a href="chapter13.html#cb244-20" aria-hidden="true"></a>                      <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;A3&quot;</span>, <span class="st">&quot;B1&quot;</span>, <span class="st">&quot;B2&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D1&quot;</span>, <span class="st">&quot;D2&quot;</span>)) <span class="op">+</span></span>
<span id="cb244-21"><a href="chapter13.html#cb244-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">shape =</span> <span class="dv">15</span>))) <span class="op">+</span></span>
<span id="cb244-22"><a href="chapter13.html#cb244-22" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_tree2</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.88</span>))</span>
<span id="cb244-23"><a href="chapter13.html#cb244-23" aria-hidden="true"></a><span class="co">## Optional</span></span>
<span id="cb244-24"><a href="chapter13.html#cb244-24" aria-hidden="true"></a><span class="co">## add labels for monophyletic (A, C and D) and paraphyletic (B) groups  </span></span>
<span id="cb244-25"><a href="chapter13.html#cb244-25" aria-hidden="true"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_cladelabel</span>(<span class="dv">94</span>, <span class="st">&quot;italic(A1)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;A1&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-26"><a href="chapter13.html#cb244-26" aria-hidden="true"></a>                    <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-27"><a href="chapter13.html#cb244-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">108</span>, <span class="st">&quot;italic(A2)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;A2&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-28"><a href="chapter13.html#cb244-28" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="fl">0.5</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-29"><a href="chapter13.html#cb244-29" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">131</span>, <span class="st">&quot;italic(A3)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;A3&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-30"><a href="chapter13.html#cb244-30" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-31"><a href="chapter13.html#cb244-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">92</span>, <span class="st">&quot;italic(A)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">offset =</span> <span class="fl">.00315</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-32"><a href="chapter13.html#cb244-32" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">0.0002</span>, <span class="dt">barsize =</span> <span class="dv">2</span>, <span class="dt">fontsize =</span> <span class="dv">5</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-33"><a href="chapter13.html#cb244-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">156</span>, <span class="st">&quot;italic(B1)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;B1&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-34"><a href="chapter13.html#cb244-34" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-35"><a href="chapter13.html#cb244-35" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">159</span>, <span class="st">&quot;italic(B2)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;B2&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-36"><a href="chapter13.html#cb244-36" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-37"><a href="chapter13.html#cb244-37" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_strip</span>(<span class="dv">65</span>, <span class="dv">71</span>, <span class="st">&quot;italic(B)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">offset =</span> <span class="fl">0.00315</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-38"><a href="chapter13.html#cb244-38" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">0.0002</span>, <span class="dt">barsize =</span> <span class="dv">2</span>, <span class="dt">fontsize =</span> <span class="dv">5</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb244-39"><a href="chapter13.html#cb244-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">163</span>, <span class="st">&quot;italic(C)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">offset =</span> <span class="fl">.0031</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-40"><a href="chapter13.html#cb244-40" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">0.0002</span>, <span class="dt">barsize =</span> <span class="fl">3.2</span>, <span class="dt">fontsize =</span> <span class="dv">5</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-41"><a href="chapter13.html#cb244-41" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">173</span>, <span class="st">&quot;italic(D1)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;D1&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-42"><a href="chapter13.html#cb244-42" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-43"><a href="chapter13.html#cb244-43" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">176</span>, <span class="st">&quot;italic(D2)&quot;</span>, <span class="dt">color =</span> cols[[<span class="st">&quot;D2&quot;</span>]], <span class="dt">offset =</span> <span class="fl">.003</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-44"><a href="chapter13.html#cb244-44" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">-.001</span>, <span class="dt">barsize =</span> <span class="fl">1.2</span>, <span class="dt">extend =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb244-45"><a href="chapter13.html#cb244-45" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_cladelabel</span>(<span class="dv">172</span>, <span class="st">&quot;italic(D)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">offset =</span> <span class="fl">.00315</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb244-46"><a href="chapter13.html#cb244-46" aria-hidden="true"></a>                   <span class="dt">offset.text =</span> <span class="fl">0.0002</span>, <span class="dt">barsize =</span> <span class="dv">2</span>, <span class="dt">fontsize =</span> <span class="dv">5</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) </span>
<span id="cb244-47"><a href="chapter13.html#cb244-47" aria-hidden="true"></a><span class="co">## Optional</span></span>
<span id="cb244-48"><a href="chapter13.html#cb244-48" aria-hidden="true"></a><span class="co">## display support values</span></span>
<span id="cb244-49"><a href="chapter13.html#cb244-49" aria-hidden="true"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_nodelab</span>(<span class="kw">aes</span>(<span class="dt">subset =</span> (node <span class="op">==</span><span class="st"> </span><span class="dv">92</span>), <span class="dt">label =</span> <span class="st">&quot;*&quot;</span>), </span>
<span id="cb244-50"><a href="chapter13.html#cb244-50" aria-hidden="true"></a>                    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">nudge_x =</span> <span class="fl">-.001</span>, <span class="dt">nudge_y =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb244-51"><a href="chapter13.html#cb244-51" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_nodelab</span>(<span class="kw">aes</span>(<span class="dt">subset =</span> (node <span class="op">==</span><span class="st"> </span><span class="dv">155</span>), <span class="dt">label =</span> <span class="st">&quot;*&quot;</span>), </span>
<span id="cb244-52"><a href="chapter13.html#cb244-52" aria-hidden="true"></a>                    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">nudge_x =</span> <span class="fl">-.0003</span>, <span class="dt">nudge_y =</span> <span class="dv">-1</span>) <span class="op">+</span></span>
<span id="cb244-53"><a href="chapter13.html#cb244-53" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_nodelab</span>(<span class="kw">aes</span>(<span class="dt">subset =</span> (node <span class="op">==</span><span class="st"> </span><span class="dv">158</span>), <span class="dt">label =</span> <span class="st">&quot;95/92/1.00&quot;</span>), </span>
<span id="cb244-54"><a href="chapter13.html#cb244-54" aria-hidden="true"></a>                    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">nudge_x =</span> <span class="fl">-0.0001</span>, <span class="dt">nudge_y =</span> <span class="dv">-1</span>, <span class="dt">hjust =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb244-55"><a href="chapter13.html#cb244-55" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_nodelab</span>(<span class="kw">aes</span>(<span class="dt">subset =</span> (node <span class="op">==</span><span class="st"> </span><span class="dv">162</span>), <span class="dt">label =</span> <span class="st">&quot;98/97/1.00&quot;</span>), </span>
<span id="cb244-56"><a href="chapter13.html#cb244-56" aria-hidden="true"></a>                    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">nudge_x =</span> <span class="fl">-0.0001</span>, <span class="dt">nudge_y =</span> <span class="dv">-1</span>, <span class="dt">hjust =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb244-57"><a href="chapter13.html#cb244-57" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_nodelab</span>(<span class="kw">aes</span>(<span class="dt">subset =</span> (node <span class="op">==</span><span class="st"> </span><span class="dv">172</span>), <span class="dt">label =</span> <span class="st">&quot;*&quot;</span>), </span>
<span id="cb244-58"><a href="chapter13.html#cb244-58" aria-hidden="true"></a>                    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">nudge_x =</span> <span class="fl">-.0003</span>, <span class="dt">nudge_y =</span> <span class="dv">-1</span>) </span></code></pre></div>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="chapter13.html#cb245-1" aria-hidden="true"></a><span class="co">## extract accession numbers from tip labels</span></span>
<span id="cb245-2"><a href="chapter13.html#cb245-2" aria-hidden="true"></a>tl &lt;-<span class="st"> </span>tree<span class="op">$</span>tip.label</span>
<span id="cb245-3"><a href="chapter13.html#cb245-3" aria-hidden="true"></a>acc &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">w+</span><span class="ch">\\</span><span class="st">|&quot;</span>, <span class="st">&quot;&quot;</span>, tl)</span>
<span id="cb245-4"><a href="chapter13.html#cb245-4" aria-hidden="true"></a><span class="kw">names</span>(tl) &lt;-<span class="st"> </span>acc</span>
<span id="cb245-5"><a href="chapter13.html#cb245-5" aria-hidden="true"></a></span>
<span id="cb245-6"><a href="chapter13.html#cb245-6" aria-hidden="true"></a><span class="co">## read sequences from GenBank directly into R</span></span>
<span id="cb245-7"><a href="chapter13.html#cb245-7" aria-hidden="true"></a><span class="co">## and convert the object to DNAStringSet</span></span>
<span id="cb245-8"><a href="chapter13.html#cb245-8" aria-hidden="true"></a>tipseq &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">read.GenBank</span>(acc) <span class="op">%&gt;%</span><span class="st"> </span>as.character <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb245-9"><a href="chapter13.html#cb245-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">lapply</span>(., paste0, <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb245-10"><a href="chapter13.html#cb245-10" aria-hidden="true"></a><span class="st">    </span>DNAStringSet</span>
<span id="cb245-11"><a href="chapter13.html#cb245-11" aria-hidden="true"></a><span class="co">## align the sequences using muscle</span></span>
<span id="cb245-12"><a href="chapter13.html#cb245-12" aria-hidden="true"></a>tipseq_aln &lt;-<span class="st"> </span>muscle<span class="op">::</span><span class="kw">muscle</span>(tipseq)</span>
<span id="cb245-13"><a href="chapter13.html#cb245-13" aria-hidden="true"></a>tipseq_aln &lt;-<span class="st"> </span><span class="kw">DNAStringSet</span>(tipseq_aln)</span></code></pre></div>


<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="chapter13.html#cb246-1" aria-hidden="true"></a><span class="co">## calculate pairwise hamming distances among sequences</span></span>
<span id="cb246-2"><a href="chapter13.html#cb246-2" aria-hidden="true"></a>tipseq_dist &lt;-<span class="st"> </span><span class="kw">stringDist</span>(tipseq_aln, <span class="dt">method =</span> <span class="st">&quot;hamming&quot;</span>)</span>
<span id="cb246-3"><a href="chapter13.html#cb246-3" aria-hidden="true"></a></span>
<span id="cb246-4"><a href="chapter13.html#cb246-4" aria-hidden="true"></a><span class="co">## calculate percentage of differences</span></span>
<span id="cb246-5"><a href="chapter13.html#cb246-5" aria-hidden="true"></a>tipseq_d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tipseq_dist) <span class="op">/</span><span class="st"> </span><span class="kw">width</span>(tipseq_aln[<span class="dv">1</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb246-6"><a href="chapter13.html#cb246-6" aria-hidden="true"></a></span>
<span id="cb246-7"><a href="chapter13.html#cb246-7" aria-hidden="true"></a><span class="co">## convert the matrix to tidy data frame for facet_plot</span></span>
<span id="cb246-8"><a href="chapter13.html#cb246-8" aria-hidden="true"></a>dd &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(tipseq_d)</span>
<span id="cb246-9"><a href="chapter13.html#cb246-9" aria-hidden="true"></a>dd<span class="op">$</span>seq1 &lt;-<span class="st"> </span><span class="kw">rownames</span>(tipseq_d)</span>
<span id="cb246-10"><a href="chapter13.html#cb246-10" aria-hidden="true"></a>td &lt;-<span class="st"> </span><span class="kw">gather</span>(dd,seq2, dist, <span class="op">-</span>seq1)</span>
<span id="cb246-11"><a href="chapter13.html#cb246-11" aria-hidden="true"></a>td<span class="op">$</span>seq1 &lt;-<span class="st"> </span>tl[td<span class="op">$</span>seq1]</span>
<span id="cb246-12"><a href="chapter13.html#cb246-12" aria-hidden="true"></a>td<span class="op">$</span>seq2 &lt;-<span class="st"> </span>tl[td<span class="op">$</span>seq2]</span>
<span id="cb246-13"><a href="chapter13.html#cb246-13" aria-hidden="true"></a></span>
<span id="cb246-14"><a href="chapter13.html#cb246-14" aria-hidden="true"></a>g &lt;-<span class="st"> </span>p<span class="op">$</span>data<span class="op">$</span>group</span>
<span id="cb246-15"><a href="chapter13.html#cb246-15" aria-hidden="true"></a><span class="kw">names</span>(g) &lt;-<span class="st"> </span>p<span class="op">$</span>data<span class="op">$</span>label</span>
<span id="cb246-16"><a href="chapter13.html#cb246-16" aria-hidden="true"></a>td<span class="op">$</span>clade &lt;-<span class="st"> </span>g[td<span class="op">$</span>seq2] </span>
<span id="cb246-17"><a href="chapter13.html#cb246-17" aria-hidden="true"></a></span>
<span id="cb246-18"><a href="chapter13.html#cb246-18" aria-hidden="true"></a><span class="co">## visualize the sequence differences using dot plot and line plot</span></span>
<span id="cb246-19"><a href="chapter13.html#cb246-19" aria-hidden="true"></a><span class="co">## and align the sequence difference plot to the tree using facet_plot</span></span>
<span id="cb246-20"><a href="chapter13.html#cb246-20" aria-hidden="true"></a>p2 &lt;-<span class="st"> </span><span class="kw">facet_plot</span>(p, <span class="dt">panel =</span> <span class="st">&quot;Sequence Distance&quot;</span>, <span class="dt">data =</span> td, geom_point, </span>
<span id="cb246-21"><a href="chapter13.html#cb246-21" aria-hidden="true"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dist, <span class="dt">color =</span> clade, <span class="dt">shape =</span> clade), <span class="dt">alpha =</span> <span class="fl">.6</span>) <span class="op">%&gt;%</span></span>
<span id="cb246-22"><a href="chapter13.html#cb246-22" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_plot</span>(<span class="dt">panel =</span> <span class="st">&quot;Sequence Distance&quot;</span>, <span class="dt">data =</span> td, <span class="dt">geom =</span> geom_path, </span>
<span id="cb246-23"><a href="chapter13.html#cb246-23" aria-hidden="true"></a>            <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x =</span> dist, <span class="dt">group =</span> seq2, <span class="dt">color =</span> clade), <span class="dt">alpha =</span> <span class="fl">.6</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb246-24"><a href="chapter13.html#cb246-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">guide =</span> <span class="ot">FALSE</span>) </span>
<span id="cb246-25"><a href="chapter13.html#cb246-25" aria-hidden="true"></a></span>
<span id="cb246-26"><a href="chapter13.html#cb246-26" aria-hidden="true"></a><span class="kw">print</span>(p2)</span></code></pre></div>
<div class="figure"><span id="fig:jv2017"></span>
<img src="treedata_files/figure-html/jv2017-1.svg" alt="Phylogeny of HPV58 complete genomes with dot and line plots of pairwise nucleotide sequence distances." width="1152" />
<p class="caption">
Figure 13.1: <strong>Phylogeny of HPV58 complete genomes with dot and line plots of pairwise nucleotide sequence distances</strong>.
</p>
</div>
</div>
<div id="symbolic-bootstrap" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Displaying different symbolic points for bootstrap values.</h2>
<p>We can cut the bootstrap values into several intervals, <em>e.g.</em> to indicate whether the clade is high, moderate or low support. Then we can use these intervals as categorical variable to set different color or shape of symbolic points to indicate the bootstrap values belong to which category.</p>


<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="chapter13.html#cb247-1" aria-hidden="true"></a><span class="kw">library</span>(treeio)</span>
<span id="cb247-2"><a href="chapter13.html#cb247-2" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb247-3"><a href="chapter13.html#cb247-3" aria-hidden="true"></a><span class="kw">library</span>(ggtree)</span>
<span id="cb247-4"><a href="chapter13.html#cb247-4" aria-hidden="true"></a></span>
<span id="cb247-5"><a href="chapter13.html#cb247-5" aria-hidden="true"></a>tree &lt;-<span class="st"> </span><span class="kw">read.newick</span>(<span class="st">&quot;data/RMI.phy_phyml_tree_rooted_labeled.txt&quot;</span>, <span class="dt">node.label=</span><span class="st">&#39;support&#39;</span>) </span>
<span id="cb247-6"><a href="chapter13.html#cb247-6" aria-hidden="true"></a>root &lt;-<span class="st"> </span><span class="kw">rootnode</span>(tree)  </span>
<span id="cb247-7"><a href="chapter13.html#cb247-7" aria-hidden="true"></a><span class="kw">ggtree</span>(tree, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">1.5</span>, <span class="dt">linetype=</span><span class="dv">1</span>,  <span class="dt">right=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-8"><a href="chapter13.html#cb247-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_tiplab</span>(<span class="dt">size=</span><span class="fl">4.5</span>, <span class="dt">hjust =</span> <span class="fl">-0.060</span>, <span class="dt">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="fl">0.09</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-9"><a href="chapter13.html#cb247-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point2</span>(<span class="kw">aes</span>(<span class="dt">subset=</span><span class="op">!</span>isTip <span class="op">&amp;</span><span class="st"> </span>node <span class="op">!=</span><span class="st"> </span>root, </span>
<span id="cb247-10"><a href="chapter13.html#cb247-10" aria-hidden="true"></a>                    <span class="dt">fill=</span><span class="kw">cut</span>(support, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">700</span>, <span class="dv">900</span>, <span class="dv">1000</span>))), </span>
<span id="cb247-11"><a href="chapter13.html#cb247-11" aria-hidden="true"></a>                    <span class="dt">shape=</span><span class="dv">21</span>, <span class="dt">size=</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-12"><a href="chapter13.html#cb247-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_tree</span>(<span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-13"><a href="chapter13.html#cb247-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">guide=</span><span class="st">&#39;legend&#39;</span>, </span>
<span id="cb247-14"><a href="chapter13.html#cb247-14" aria-hidden="true"></a>                    <span class="dt">name=</span><span class="st">&#39;Bootstrap Percentage(BP)&#39;</span>, </span>
<span id="cb247-15"><a href="chapter13.html#cb247-15" aria-hidden="true"></a>                    <span class="dt">breaks=</span><span class="kw">c</span>(<span class="st">&#39;(900,1e+03]&#39;</span>, <span class="st">&#39;(700,900]&#39;</span>, <span class="st">&#39;(0,700]&#39;</span>), </span>
<span id="cb247-16"><a href="chapter13.html#cb247-16" aria-hidden="true"></a>                    <span class="dt">labels=</span><span class="kw">expression</span>(BP<span class="op">&gt;=</span><span class="dv">90</span>,<span class="dv">70</span> <span class="op">&lt;=</span><span class="st"> </span>BP <span class="op">*</span><span class="st"> &quot; &lt; 90&quot;</span>, BP <span class="op">&lt;</span><span class="st"> </span><span class="dv">70</span>))</span></code></pre></div>
<div class="figure"><span id="fig:bpinterval"></span>
<img src="treedata_files/figure-html/bpinterval-1.jpeg" alt="Partitioning bootstrap values. Bootstrap values were divided into three categories and this information was used to color circle points." width="720" />
<p class="caption">
Figure 13.2: <strong>Partitioning bootstrap values</strong>. Bootstrap values were divided into three categories and this information was used to color circle points.
</p>
</div>
</div>
<div id="phylo-grouping" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Highlighting different groups.</h2>
<p>This example reproduces Figure 1 of <span class="citation">(Larsen et al. <a href="#ref-larsen_identification_2019" role="doc-biblioref">2019</a>)</span>. It used <code>groupOTU</code> to add grouping information of chicken CTLDcps. The branch linetype and color are defined based on this grouping information. Two groups of CTLDcps are highlighted in different background colors using <code>geom_hilight</code> (red for Group II and green for Group V). The avian-specific expansion of group V with subgroup of A and B- are labelled using <code>geom_cladelabel</code> (Figure <a href="chapter13.html#fig:treeLarsen">13.3</a>).</p>


<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="chapter13.html#cb248-1" aria-hidden="true"></a>mytree &lt;-<span class="st"> </span><span class="kw">read.tree</span>(<span class="st">&quot;data/Tree 30.4.19.nwk&quot;</span>)</span>
<span id="cb248-2"><a href="chapter13.html#cb248-2" aria-hidden="true"></a></span>
<span id="cb248-3"><a href="chapter13.html#cb248-3" aria-hidden="true"></a><span class="co"># Define nodes for coloring later on</span></span>
<span id="cb248-4"><a href="chapter13.html#cb248-4" aria-hidden="true"></a>tiplab &lt;-<span class="st"> </span>mytree<span class="op">$</span>tip.label</span>
<span id="cb248-5"><a href="chapter13.html#cb248-5" aria-hidden="true"></a>cls &lt;-<span class="st"> </span>tiplab[<span class="kw">grep</span>(<span class="st">&quot;^ch&quot;</span>, tiplab)] </span>
<span id="cb248-6"><a href="chapter13.html#cb248-6" aria-hidden="true"></a>labeltree &lt;-<span class="st"> </span><span class="kw">groupOTU</span>(mytree, cls)</span>
<span id="cb248-7"><a href="chapter13.html#cb248-7" aria-hidden="true"></a></span>
<span id="cb248-8"><a href="chapter13.html#cb248-8" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">ggtree</span>(labeltree, <span class="kw">aes</span>(<span class="dt">color=</span>group, <span class="dt">linetype=</span>group), <span class="dt">layout=</span><span class="st">&quot;circular&quot;</span>) <span class="op">+</span></span>
<span id="cb248-9"><a href="chapter13.html#cb248-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#efad29&quot;</span>, <span class="st">&quot;#63bbd4&quot;</span>)) <span class="op">+</span></span>
<span id="cb248-10"><a href="chapter13.html#cb248-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_nodepoint</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb248-11"><a href="chapter13.html#cb248-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_tiplab</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb248-12"><a href="chapter13.html#cb248-12" aria-hidden="true"></a></span>
<span id="cb248-13"><a href="chapter13.html#cb248-13" aria-hidden="true"></a>p2 &lt;-<span class="st"> </span><span class="kw">flip</span>(p, <span class="dv">136</span>, <span class="dv">110</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-14"><a href="chapter13.html#cb248-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">flip</span>(<span class="dv">141</span>, <span class="dv">145</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-15"><a href="chapter13.html#cb248-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">rotate</span>(<span class="dv">141</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-16"><a href="chapter13.html#cb248-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">rotate</span>(<span class="dv">142</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-17"><a href="chapter13.html#cb248-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">rotate</span>(<span class="dv">160</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-18"><a href="chapter13.html#cb248-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">rotate</span>(<span class="dv">164</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-19"><a href="chapter13.html#cb248-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">rotate</span>(<span class="dv">131</span>)</span>
<span id="cb248-20"><a href="chapter13.html#cb248-20" aria-hidden="true"></a></span>
<span id="cb248-21"><a href="chapter13.html#cb248-21" aria-hidden="true"></a><span class="co">### Group V and II coloring </span></span>
<span id="cb248-22"><a href="chapter13.html#cb248-22" aria-hidden="true"></a>p3 &lt;-<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">geom_hilight</span>(<span class="dt">node =</span> <span class="dv">110</span>, <span class="dt">fill =</span> <span class="st">&quot;#229f8a&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">extend =</span> <span class="fl">0.43</span>) <span class="op">+</span><span class="st">    </span></span>
<span id="cb248-23"><a href="chapter13.html#cb248-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hilight</span>(<span class="dt">node =</span> <span class="dv">88</span>, <span class="dt">fill =</span> <span class="st">&quot;#229f8a&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">extend =</span> <span class="fl">0.445</span>) <span class="op">+</span></span>
<span id="cb248-24"><a href="chapter13.html#cb248-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hilight</span>(<span class="dt">node =</span> <span class="dv">156</span>, <span class="dt">fill =</span> <span class="st">&quot;#229f8a&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">extend =</span> <span class="fl">0.35</span>) <span class="op">+</span></span>
<span id="cb248-25"><a href="chapter13.html#cb248-25" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hilight</span>(<span class="dt">node =</span> <span class="dv">136</span>, <span class="dt">fill =</span> <span class="st">&quot;#f9311f&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">extend =</span> <span class="fl">0.512</span>)</span>
<span id="cb248-26"><a href="chapter13.html#cb248-26" aria-hidden="true"></a></span>
<span id="cb248-27"><a href="chapter13.html#cb248-27" aria-hidden="true"></a><span class="co">### Putting on a label on the avian specific expansion </span></span>
<span id="cb248-28"><a href="chapter13.html#cb248-28" aria-hidden="true"></a>p4 &lt;-<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">geom_cladelabel</span>(<span class="dt">node =</span> <span class="dv">113</span>, <span class="dt">label =</span> <span class="st">&quot;Avian-specific expansion&quot;</span>, </span>
<span id="cb248-29"><a href="chapter13.html#cb248-29" aria-hidden="true"></a>                        <span class="dt">align =</span> <span class="ot">TRUE</span>, <span class="dt">angle =</span> <span class="dv">-35</span>, <span class="dt">offset.text =</span> <span class="fl">0.05</span>, </span>
<span id="cb248-30"><a href="chapter13.html#cb248-30" aria-hidden="true"></a>                        <span class="dt">hjust =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">2</span>,  <span class="dt">offset =</span> <span class="fl">0.2</span>, <span class="dt">barsize =</span> <span class="fl">0.2</span>)</span>
<span id="cb248-31"><a href="chapter13.html#cb248-31" aria-hidden="true"></a>    </span>
<span id="cb248-32"><a href="chapter13.html#cb248-32" aria-hidden="true"></a><span class="co">### Adding the bootstrap values with subset used to remove all bootstraps &lt; 50  </span></span>
<span id="cb248-33"><a href="chapter13.html#cb248-33" aria-hidden="true"></a>p5 &lt;-<span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span><span class="kw">geom_text2</span>(<span class="kw">aes</span>(<span class="dt">label=</span>label, </span>
<span id="cb248-34"><a href="chapter13.html#cb248-34" aria-hidden="true"></a>                        <span class="dt">subset =</span> <span class="op">!</span><span class="kw">is.na</span>(<span class="kw">as.numeric</span>(label)) <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.numeric</span>(label) <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>), </span>
<span id="cb248-35"><a href="chapter13.html#cb248-35" aria-hidden="true"></a>                    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">nudge_y =</span> <span class="fl">0.7</span>, <span class="dt">nudge_x =</span> <span class="fl">-0.05</span>)</span>
<span id="cb248-36"><a href="chapter13.html#cb248-36" aria-hidden="true"></a> </span>
<span id="cb248-37"><a href="chapter13.html#cb248-37" aria-hidden="true"></a><span class="co">### Putting labels on the subgroups </span></span>
<span id="cb248-38"><a href="chapter13.html#cb248-38" aria-hidden="true"></a>p6 &lt;-<span class="st"> </span>p5 <span class="op">+</span><span class="st"> </span><span class="kw">geom_cladelabel</span>(<span class="dt">node =</span> <span class="dv">114</span>, <span class="dt">label =</span> <span class="st">&quot;Subgroup A&quot;</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb248-39"><a href="chapter13.html#cb248-39" aria-hidden="true"></a>                        <span class="dt">angle =</span> <span class="dv">-55</span>, <span class="dt">offset.text =</span> <span class="fl">.03</span>, <span class="dt">hjust =</span> <span class="st">&quot;center&quot;</span>, </span>
<span id="cb248-40"><a href="chapter13.html#cb248-40" aria-hidden="true"></a>                        <span class="dt">offset =</span> <span class="fl">0.05</span>, <span class="dt">barsize =</span> <span class="fl">0.2</span>, <span class="dt">fontsize =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb248-41"><a href="chapter13.html#cb248-41" aria-hidden="true"></a><span class="st">            </span><span class="kw">geom_cladelabel</span>(<span class="dt">node =</span> <span class="dv">121</span>, <span class="dt">label =</span> <span class="st">&quot;Subgroup B&quot;</span>, <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb248-42"><a href="chapter13.html#cb248-42" aria-hidden="true"></a>                        <span class="dt">angle =</span> <span class="dv">-15</span>, <span class="dt">offset.text =</span> <span class="fl">.03</span>, <span class="dt">hjust =</span> <span class="st">&quot;center&quot;</span>, </span>
<span id="cb248-43"><a href="chapter13.html#cb248-43" aria-hidden="true"></a>                        <span class="dt">offset =</span> <span class="fl">0.05</span>, <span class="dt">barsize =</span> <span class="fl">0.2</span>, <span class="dt">fontsize =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb248-44"><a href="chapter13.html#cb248-44" aria-hidden="true"></a><span class="st">            </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>, </span>
<span id="cb248-45"><a href="chapter13.html#cb248-45" aria-hidden="true"></a>                <span class="dt">plot.margin=</span>grid<span class="op">::</span><span class="kw">unit</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">15</span>,<span class="op">-</span><span class="dv">15</span>,<span class="op">-</span><span class="dv">15</span>,<span class="op">-</span><span class="dv">15</span>), <span class="st">&quot;mm&quot;</span>))</span>
<span id="cb248-46"><a href="chapter13.html#cb248-46" aria-hidden="true"></a></span>
<span id="cb248-47"><a href="chapter13.html#cb248-47" aria-hidden="true"></a><span class="kw">print</span>(p6)</span></code></pre></div>
<div class="figure"><span id="fig:treeLarsen"></span>
<img src="treedata_files/figure-html/treeLarsen-1.svg" alt="Phylogenetic tree of CTLDcps." width="720" />
<p class="caption">
Figure 13.3: <strong>Phylogenetic tree of CTLDcps</strong>.
</p>
</div>
</div>
<div id="genome-locus" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Phylogenetic tree with genome locus structure</h2>
<p>The <code>geom_motif</code> is defined in <code>ggtree</code> and it is a wrapper layer of <code>gggenes::geom_gene_arrow</code>. The <code>geom_motif</code> can automatically adjust genomic alignment by selective gene (via the <code>on</code> parameter) and can label genes via the <code>label</code> parameter. In the following example, we use <code>example_genes</code> dataset provided by <a href="https://CRAN.R-project.org/package=gggenes">gggenes</a>. As the dataset only provide genomic coordinations of a set of genes, a phylogeny for the genomes need to be firstly constructed. We calculate jaccard similarity based on the ratio of overlapping genes among genomes and correspondingly determine genome distance. BioNJ algorithm was applied to construct the tree (Figure <a href="chapter13.html#fig:gggenes">13.4</a>).</p>


<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="chapter13.html#cb249-1" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb249-2"><a href="chapter13.html#cb249-2" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb249-3"><a href="chapter13.html#cb249-3" aria-hidden="true"></a><span class="kw">library</span>(gggenes)</span>
<span id="cb249-4"><a href="chapter13.html#cb249-4" aria-hidden="true"></a><span class="kw">library</span>(ggtree)</span>
<span id="cb249-5"><a href="chapter13.html#cb249-5" aria-hidden="true"></a></span>
<span id="cb249-6"><a href="chapter13.html#cb249-6" aria-hidden="true"></a>get_genes &lt;-<span class="st"> </span><span class="cf">function</span>(data, genome) {</span>
<span id="cb249-7"><a href="chapter13.html#cb249-7" aria-hidden="true"></a>    <span class="kw">filter</span>(data, molecule <span class="op">==</span><span class="st"> </span>genome) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(gene)</span>
<span id="cb249-8"><a href="chapter13.html#cb249-8" aria-hidden="true"></a>}</span>
<span id="cb249-9"><a href="chapter13.html#cb249-9" aria-hidden="true"></a></span>
<span id="cb249-10"><a href="chapter13.html#cb249-10" aria-hidden="true"></a>g &lt;-<span class="st"> </span><span class="kw">unique</span>(example_genes[,<span class="dv">1</span>])</span>
<span id="cb249-11"><a href="chapter13.html#cb249-11" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(g)</span>
<span id="cb249-12"><a href="chapter13.html#cb249-12" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> n, <span class="dt">ncol =</span> n)</span>
<span id="cb249-13"><a href="chapter13.html#cb249-13" aria-hidden="true"></a><span class="kw">rownames</span>(d) &lt;-<span class="st"> </span><span class="kw">colnames</span>(d) &lt;-<span class="st"> </span>g</span>
<span id="cb249-14"><a href="chapter13.html#cb249-14" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">lapply</span>(g, get_genes, <span class="dt">data =</span> example_genes)</span>
<span id="cb249-15"><a href="chapter13.html#cb249-15" aria-hidden="true"></a></span>
<span id="cb249-16"><a href="chapter13.html#cb249-16" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb249-17"><a href="chapter13.html#cb249-17" aria-hidden="true"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i) {</span>
<span id="cb249-18"><a href="chapter13.html#cb249-18" aria-hidden="true"></a>        jaccard_sim &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">intersect</span>(genes[[i]], genes[[j]])) <span class="op">/</span><span class="st"> </span></span>
<span id="cb249-19"><a href="chapter13.html#cb249-19" aria-hidden="true"></a><span class="st">                       </span><span class="kw">length</span>(<span class="kw">union</span>(genes[[i]], genes[[j]]))</span>
<span id="cb249-20"><a href="chapter13.html#cb249-20" aria-hidden="true"></a>        d[j, i] &lt;-<span class="st"> </span>d[i, j] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>jaccard_sim</span>
<span id="cb249-21"><a href="chapter13.html#cb249-21" aria-hidden="true"></a>    }</span>
<span id="cb249-22"><a href="chapter13.html#cb249-22" aria-hidden="true"></a>}</span>
<span id="cb249-23"><a href="chapter13.html#cb249-23" aria-hidden="true"></a></span>
<span id="cb249-24"><a href="chapter13.html#cb249-24" aria-hidden="true"></a>tree &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">bionj</span>(d) </span>
<span id="cb249-25"><a href="chapter13.html#cb249-25" aria-hidden="true"></a></span>
<span id="cb249-26"><a href="chapter13.html#cb249-26" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">ggtree</span>(tree, <span class="dt">branch.length=</span><span class="st">&#39;none&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-27"><a href="chapter13.html#cb249-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_tiplab</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlim_tree</span>(<span class="fl">5.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-28"><a href="chapter13.html#cb249-28" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_facet</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">xmin =</span> start, <span class="dt">xmax =</span> end, <span class="dt">fill =</span> gene),</span>
<span id="cb249-29"><a href="chapter13.html#cb249-29" aria-hidden="true"></a>               <span class="dt">data =</span> example_genes, <span class="dt">geom =</span> geom_motif, <span class="dt">panel =</span> <span class="st">&#39;Alignment&#39;</span>,</span>
<span id="cb249-30"><a href="chapter13.html#cb249-30" aria-hidden="true"></a>               <span class="dt">on =</span> <span class="st">&#39;genE&#39;</span>, <span class="dt">label =</span> <span class="st">&#39;gene&#39;</span>, <span class="dt">align =</span> <span class="st">&#39;left&#39;</span>) <span class="op">+</span></span>
<span id="cb249-31"><a href="chapter13.html#cb249-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-32"><a href="chapter13.html#cb249-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb249-33"><a href="chapter13.html#cb249-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text=</span><span class="kw">element_blank</span>(),</span>
<span id="cb249-34"><a href="chapter13.html#cb249-34" aria-hidden="true"></a>        <span class="dt">panel.spacing=</span><span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb249-35"><a href="chapter13.html#cb249-35" aria-hidden="true"></a></span>
<span id="cb249-36"><a href="chapter13.html#cb249-36" aria-hidden="true"></a><span class="kw">facet_widths</span>(p, <span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="figure"><span id="fig:gggenes"></span>
<img src="treedata_files/figure-html/gggenes-1.svg" alt="Genomic features with phylogenetic tree." width="864" />
<p class="caption">
Figure 13.4: <strong>Genomic features with phylogenetic tree.</strong>
</p>
</div>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-chen_ancient_2017">
<p>Chen, Zigui, Wendy C. S. Ho, Siaw Shi Boon, Priscilla T. Y. Law, Martin C. W. Chan, Rob DeSalle, Robert D. Burk, and Paul K. S. Chan. 2017. ‚ÄúAncient Evolution and Dispersion of Human Papillomavirus 58 Variants.‚Äù <em>Journal of Virology</em> 91 (21): e01285‚Äì17. <a href="https://doi.org/10.1128/JVI.01285-17">https://doi.org/10.1128/JVI.01285-17</a>.</p>
</div>
<div id="ref-larsen_identification_2019">
<p>Larsen, Frederik T., Bertrand Bed‚ÄôHom, Bernt Guldbrandtsen, and Tina S. Dalgaard. 2019. ‚ÄúIdentification and Tissue-Expression Profiling of Novel Chicken c-Type Lectin-Like Domain Containing Proteins as Potential Targets for Carbohydrate-Based Vaccine Strategies.‚Äù <em>Molecular Immunology</em> 114 (October): 216‚Äì25. <a href="https://doi.org/10.1016/j.molimm.2019.07.022">https://doi.org/10.1016/j.molimm.2019.07.022</a>.</p>
</div>
<div id="ref-yu_two_2018">
<p>Yu, Guangchuang, Tommy Tsan-Yuk Lam, Huachen Zhu, and Yi Guan. 2018. ‚ÄúTwo Methods for Mapping and Visualizing Associated Data on Phylogeny Using Ggtree.‚Äù <em>Molecular Biology and Evolution</em> 35 (12): 3041‚Äì3. <a href="https://doi.org/10.1093/molbev/msy194">https://doi.org/10.1093/molbev/msy194</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter12.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="faq.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["treedata.pdf", "treedata.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
