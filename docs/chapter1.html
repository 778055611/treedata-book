<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Importing Tree with Data | Data Integration, Manipulation and Visualization of Phylogenetic Trees</title>
  <meta name="description" content="Chapter 1 Importing Tree with Data | Data Integration, Manipulation and Visualization of Phylogenetic Trees" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Importing Tree with Data | Data Integration, Manipulation and Visualization of Phylogenetic Trees" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Importing Tree with Data | Data Integration, Manipulation and Visualization of Phylogenetic Trees" />
  
  
  



<meta name="date" content="2020-07-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="chapter2.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/pathseg-1.0.2/pathseg.js"></script>
<script src="libs/comic-0.961/comic.min.js"></script>
<script src="libs/comicR-binding-0.2/comicR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-structure"><i class="fa fa-check"></i>Book structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#want-to-help"><i class="fa fa-check"></i>Want to help?</a></li>
</ul></li>
<li class="part"><span><b>Part I: Tree data input, output and manipulation</b></span></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Importing Tree with Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#pc"><i class="fa fa-check"></i><b>1.1</b> Overview of Phylogenetic Tree Construction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#format"><i class="fa fa-check"></i><b>1.2</b> Phylogenetic Tree Formats</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#newick-tree-format"><i class="fa fa-check"></i><b>1.2.1</b> Newick tree format</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#nexus-tree-format"><i class="fa fa-check"></i><b>1.2.2</b> NEXUS tree format</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapter1.html"><a href="chapter1.html#nhxtext"><i class="fa fa-check"></i><b>1.2.3</b> New Hampshire eXtended format</a></li>
<li class="chapter" data-level="1.2.4" data-path="chapter1.html"><a href="chapter1.html#jplace-format"><i class="fa fa-check"></i><b>1.2.4</b> Jplace format</a></li>
<li class="chapter" data-level="1.2.5" data-path="chapter1.html"><a href="chapter1.html#software-outputs"><i class="fa fa-check"></i><b>1.2.5</b> Software outputs</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#getting-tree-data-with-treeio"><i class="fa fa-check"></i><b>1.3</b> Getting Tree Data with <em>treeio</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chapter1.html"><a href="chapter1.html#overview-of-treeio"><i class="fa fa-check"></i><b>1.3.1</b> Overview of <em>treeio</em></a></li>
<li class="chapter" data-level="1.3.2" data-path="chapter1.html"><a href="chapter1.html#function-demonstration"><i class="fa fa-check"></i><b>1.3.2</b> Function Demonstration</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapter1.html"><a href="chapter1.html#as-treedata"><i class="fa fa-check"></i><b>1.3.3</b> Converting other tree object to <code>treedata</code> object</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapter1.html"><a href="chapter1.html#get-treedata-data"><i class="fa fa-check"></i><b>1.3.4</b> Getting information from <code>treedata</code> object</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Manipulating Tree with Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#tidytree"><i class="fa fa-check"></i><b>2.1</b> Manipulating tree data using tidy interface</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#the-phylo-object"><i class="fa fa-check"></i><b>2.1.1</b> The <code>phylo</code> object</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#the-treedata-object"><i class="fa fa-check"></i><b>2.1.2</b> The <code>treedata</code> object</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#accesor-tidytree"><i class="fa fa-check"></i><b>2.1.3</b> Access related nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#data-integration"><i class="fa fa-check"></i><b>2.2</b> Data Integration</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#merge-tree"><i class="fa fa-check"></i><b>2.2.1</b> Combining tree data</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter2.html"><a href="chapter2.html#link-external-data"><i class="fa fa-check"></i><b>2.2.2</b> Linking external data to phylogeny</a></li>
<li class="chapter" data-level="2.2.3" data-path="chapter2.html"><a href="chapter2.html#grouping-taxa"><i class="fa fa-check"></i><b>2.2.3</b> Grouping taxa</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#rescale-treeio"><i class="fa fa-check"></i><b>2.3</b> Rescaling Tree Branches</a></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#subsetting-tree-with-data"><i class="fa fa-check"></i><b>2.4</b> Subsetting Tree with Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chapter2.html"><a href="chapter2.html#remove-tip"><i class="fa fa-check"></i><b>2.4.1</b> Removing tips in a phylogenetic tree</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapter2.html"><a href="chapter2.html#subset-tip"><i class="fa fa-check"></i><b>2.4.2</b> Subsetting tree by tip label</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapter2.html"><a href="chapter2.html#subset-node"><i class="fa fa-check"></i><b>2.4.3</b> Subsetting tree by internal node number</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#ggtree-fortify"><i class="fa fa-check"></i><b>2.5</b> Manipulating tree data for visualization</a></li>
<li class="chapter" data-level="2.6" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Exporting tree with data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#exporting-tree-data-to-beast-nexus-format"><i class="fa fa-check"></i><b>3.2</b> Exporting Tree Data to <em>BEAST</em> Nexus Format</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#exportingconverting-software-output"><i class="fa fa-check"></i><b>3.2.1</b> Exporting/converting software output</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter3.html"><a href="chapter3.html#combining-tree-with-external-data"><i class="fa fa-check"></i><b>3.2.2</b> Combining tree with external data</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter3.html"><a href="chapter3.html#merging-tree-data-from-different-sources"><i class="fa fa-check"></i><b>3.2.3</b> Merging tree data from different sources</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#write-jtree"><i class="fa fa-check"></i><b>3.3</b> Exporting Tree Data to <em>jtree</em> Format</a></li>
<li class="chapter" data-level="3.4" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>Part II: Tree data visualization and annotation</b></span></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> Phylogenetic Tree Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#visualizing-phylogenetic-tree-with-ggtree"><i class="fa fa-check"></i><b>4.2</b> Visualizing Phylogenetic Tree with <em>ggtree</em></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chapter4.html"><a href="chapter4.html#basic-tree-visualization"><i class="fa fa-check"></i><b>4.2.1</b> Basic Tree Visualization</a></li>
<li class="chapter" data-level="4.2.2" data-path="chapter4.html"><a href="chapter4.html#tree-layouts"><i class="fa fa-check"></i><b>4.2.2</b> Layouts of phylogenetic tree</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#displaying-tree-components"><i class="fa fa-check"></i><b>4.3</b> Displaying Tree Components</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter4.html"><a href="chapter4.html#geom-trescale"><i class="fa fa-check"></i><b>4.3.1</b> Displaying tree scale (evolution distance)</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter4.html"><a href="chapter4.html#geom-nodepoint"><i class="fa fa-check"></i><b>4.3.2</b> Displaying nodes/tips</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter4.html"><a href="chapter4.html#displaying-labels"><i class="fa fa-check"></i><b>4.3.3</b> Displaying labels</a></li>
<li class="chapter" data-level="4.3.4" data-path="chapter4.html"><a href="chapter4.html#displaying-root-edge"><i class="fa fa-check"></i><b>4.3.4</b> Displaying root edge</a></li>
<li class="chapter" data-level="4.3.5" data-path="chapter4.html"><a href="chapter4.html#color-tree"><i class="fa fa-check"></i><b>4.3.5</b> Color tree</a></li>
<li class="chapter" data-level="4.3.6" data-path="chapter4.html"><a href="chapter4.html#rescale-tree"><i class="fa fa-check"></i><b>4.3.6</b> Rescale tree</a></li>
<li class="chapter" data-level="4.3.7" data-path="chapter4.html"><a href="chapter4.html#modify-compenents-of-a-theme"><i class="fa fa-check"></i><b>4.3.7</b> Modify compenents of a theme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#visualize-a-list-of-trees"><i class="fa fa-check"></i><b>4.4</b> Visualize a list of trees</a></li>
<li class="chapter" data-level="4.5" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Phylogenetic Tree Annotation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#visualizing-and-annotating-tree-using-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1</b> Visualizing and Annotating Tree using Grammar of Graphics</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#layers-for-tree-annotation"><i class="fa fa-check"></i><b>5.2</b> Layers for Tree Annotation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter5.html"><a href="chapter5.html#colored-strips"><i class="fa fa-check"></i><b>5.2.1</b> Colored strips</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter5.html"><a href="chapter5.html#highlight-clades"><i class="fa fa-check"></i><b>5.2.2</b> Highlight clades</a></li>
<li class="chapter" data-level="5.2.3" data-path="chapter5.html"><a href="chapter5.html#taxa-connection"><i class="fa fa-check"></i><b>5.2.3</b> Taxa connection</a></li>
<li class="chapter" data-level="5.2.4" data-path="chapter5.html"><a href="chapter5.html#uncertainty-of-evolutionary-inference"><i class="fa fa-check"></i><b>5.2.4</b> Uncertainty of evolutionary inference</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#tree-annotation-with-output-from-evolution-software"><i class="fa fa-check"></i><b>5.3</b> Tree annotation with output from evolution software</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#tree-annotation-using-data-from-evolutionary-analysis-software"><i class="fa fa-check"></i><b>5.3.1</b> Tree annotation using data from evolutionary analysis software</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Visual Exploration of Phylogenetic Tree</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#viewing-selected-clade"><i class="fa fa-check"></i><b>6.1</b> Viewing Selected Clade</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#scale-clade"><i class="fa fa-check"></i><b>6.2</b> Scaling Selected Clade</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#collapsing-and-expanding-clade"><i class="fa fa-check"></i><b>6.3</b> Collapsing and Expanding Clade</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#group-taxa-vis"><i class="fa fa-check"></i><b>6.4</b> Grouping Taxa</a></li>
<li class="chapter" data-level="6.5" data-path="chapter6.html"><a href="chapter6.html#exploring-tree-structure"><i class="fa fa-check"></i><b>6.5</b> Exploring tree structure</a></li>
<li class="chapter" data-level="6.6" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Plotting tree with data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#attach-operator"><i class="fa fa-check"></i><b>7.1</b> Mapping data to the tree structure</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#facet_plot"><i class="fa fa-check"></i><b>7.2</b> Aligning graph to the tree based on tree structure</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#gheatmap"><i class="fa fa-check"></i><b>7.3</b> Visualize tree with associated matrix</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter7.html"><a href="chapter7.html#gheatmap-ggnewscale"><i class="fa fa-check"></i><b>7.3.1</b> Visualize tree with multiple associated matrix</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#msaplot"><i class="fa fa-check"></i><b>7.4</b> Visualize tree with multiple sequence alignment</a></li>
<li class="chapter" data-level="7.5" data-path="chapter7.html"><a href="chapter7.html#composite_plot"><i class="fa fa-check"></i><b>7.5</b> Composite plots</a></li>
<li class="chapter" data-level="7.6" data-path="chapter7.html"><a href="chapter7.html#ggtree_object"><i class="fa fa-check"></i><b>7.6</b> The <code>ggtree</code> object</a></li>
<li class="chapter" data-level="7.7" data-path="chapter1.html"><a href="chapter1.html#summary"><i class="fa fa-check"></i><b>7.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> Annotating Tree with Silhouette Images and Sub-plots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#ggimage"><i class="fa fa-check"></i><b>8.1</b> Annotating Tree with Images</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#phylopic"><i class="fa fa-check"></i><b>8.2</b> Annotating Tree with Phylopic</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#subplots"><i class="fa fa-check"></i><b>8.3</b> Annotating Tree with Sub-plots</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter8.html"><a href="chapter8.html#annotate-with-bar-charts"><i class="fa fa-check"></i><b>8.3.1</b> Annotate with bar charts</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapter8.html"><a href="chapter8.html#annotate-with-pie-charts"><i class="fa fa-check"></i><b>8.3.2</b> Annotate with pie charts</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapter8.html"><a href="chapter8.html#annotate-with-other-types-of-charts"><i class="fa fa-check"></i><b>8.3.3</b> Annotate with other types of charts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter8.html"><a href="chapter8.html#phylomoji"><i class="fa fa-check"></i><b>8.4</b> Have Fun with Phylomoji</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chapter8.html"><a href="chapter8.html#emoji-in-circularfan-layout-tree"><i class="fa fa-check"></i><b>8.4.1</b> Emoji in circular/fan layout tree</a></li>
<li class="chapter" data-level="8.4.2" data-path="chapter8.html"><a href="chapter8.html#emoji-to-label-clades"><i class="fa fa-check"></i><b>8.4.2</b> Emoji to label clades</a></li>
<li class="chapter" data-level="8.4.3" data-path="chapter8.html"><a href="chapter8.html#apple-color-emoji"><i class="fa fa-check"></i><b>8.4.3</b> Apple Color Emoji</a></li>
<li class="chapter" data-level="8.4.4" data-path="chapter8.html"><a href="chapter8.html#phylomoji-in-ascii-art"><i class="fa fa-check"></i><b>8.4.4</b> Phylomoji in ASCII art</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> ggtree for other tree-like objects</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#ggtree-for-phylogenetic-tree-objects"><i class="fa fa-check"></i><b>9.1</b> ggtree for phylogenetic tree objects</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter9.html"><a href="chapter9.html#phylobase"><i class="fa fa-check"></i><b>9.1.1</b> The phylo4 and phylo4d objects</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapter9.html"><a href="chapter9.html#phylog"><i class="fa fa-check"></i><b>9.1.2</b> The phylog object</a></li>
<li class="chapter" data-level="9.1.3" data-path="chapter9.html"><a href="chapter9.html#phyloseq"><i class="fa fa-check"></i><b>9.1.3</b> The phyloseq object</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#dendrogram"><i class="fa fa-check"></i><b>9.2</b> ggtree for dendrograms</a></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#igraph"><i class="fa fa-check"></i><b>9.3</b> ggtree for tree graph</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#ggtree-for-other-tree-like-structure"><i class="fa fa-check"></i><b>9.4</b> ggtree for other tree-like structure</a></li>
</ul></li>
<li class="part"><span><b>Part III: Miscellaneous topics</b></span></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> ggtree utilities</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#facet-utilities"><i class="fa fa-check"></i><b>10.1</b> facet utilities</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="chapter10.html"><a href="chapter10.html#facet_widths"><i class="fa fa-check"></i><b>10.1.1</b> facet_widths</a></li>
<li class="chapter" data-level="10.1.2" data-path="chapter10.html"><a href="chapter10.html#facet_labeller"><i class="fa fa-check"></i><b>10.1.2</b> facet_labeller</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#geom2"><i class="fa fa-check"></i><b>10.2</b> Geometric layers</a></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#layout-utilities"><i class="fa fa-check"></i><b>10.3</b> Layout utilities</a></li>
<li class="chapter" data-level="10.4" data-path="chapter10.html"><a href="chapter10.html#legend-utilities"><i class="fa fa-check"></i><b>10.4</b> Legend utilities</a></li>
<li class="chapter" data-level="10.5" data-path="chapter10.html"><a href="chapter10.html#scale-utilities"><i class="fa fa-check"></i><b>10.5</b> Scale utilities</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chapter10.html"><a href="chapter10.html#xlim_expand"><i class="fa fa-check"></i><b>10.5.1</b> xlim_expand</a></li>
<li class="chapter" data-level="10.5.2" data-path="chapter10.html"><a href="chapter10.html#hexpand"><i class="fa fa-check"></i><b>10.5.2</b> hexpand</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>11</b> Gallery of reproducible examples</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter11.html"><a href="chapter11.html#hpv58"><i class="fa fa-check"></i><b>11.1</b> Visualizing pairwise nucleotide sequence distance with phylogenetic tree</a></li>
<li class="chapter" data-level="11.2" data-path="chapter11.html"><a href="chapter11.html#symbolic-bootstrap"><i class="fa fa-check"></i><b>11.2</b> Displaying different symbolic points for bootstrap values.</a></li>
<li class="chapter" data-level="11.3" data-path="chapter11.html"><a href="chapter11.html#phylo-grouping"><i class="fa fa-check"></i><b>11.3</b> Highlighting different groups.</a></li>
<li class="chapter" data-level="11.4" data-path="chapter11.html"><a href="chapter11.html#genome-locus"><i class="fa fa-check"></i><b>11.4</b> Phylogenetic tree with genome locus structure</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapter12.html"><a href="chapter12.html"><i class="fa fa-check"></i><b>12</b> ggtree extensions</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently asked questions</a>
<ul>
<li class="chapter" data-level="A.1" data-path="faq.html"><a href="faq.html#installation"><i class="fa fa-check"></i><b>A.1</b> Installation</a></li>
<li class="chapter" data-level="A.2" data-path="faq.html"><a href="faq.html#faq-r"><i class="fa fa-check"></i><b>A.2</b> Basic R related</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="faq.html"><a href="faq.html#faq-local-file"><i class="fa fa-check"></i><b>A.2.1</b> Use your local file</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="faq.html"><a href="faq.html#faq-aes-mapping"><i class="fa fa-check"></i><b>A.3</b> Aesthetic mapping</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="faq.html"><a href="faq.html#faq-inherit-aes"><i class="fa fa-check"></i><b>A.3.1</b> Inherit <em>aes</em></a></li>
<li class="chapter" data-level="A.3.2" data-path="faq.html"><a href="faq.html#faq-dollar-aes"><i class="fa fa-check"></i><b>A.3.2</b> Never use <code>$</code> in aes</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="faq.html"><a href="faq.html#faq-text"><i class="fa fa-check"></i><b>A.4</b> Text &amp; Label</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="faq.html"><a href="faq.html#faq-label-truncated"><i class="fa fa-check"></i><b>A.4.1</b> Tip label truncated</a></li>
<li class="chapter" data-level="A.4.2" data-path="faq.html"><a href="faq.html#faq-modify-label"><i class="fa fa-check"></i><b>A.4.2</b> Modify (tip) labels</a></li>
<li class="chapter" data-level="A.4.3" data-path="faq.html"><a href="faq.html#faq-formatting-label"><i class="fa fa-check"></i><b>A.4.3</b> Formatting (tip) labels</a></li>
<li class="chapter" data-level="A.4.4" data-path="faq.html"><a href="faq.html#faq-ggrepel"><i class="fa fa-check"></i><b>A.4.4</b> Avoid overlapping text labels</a></li>
<li class="chapter" data-level="A.4.5" data-path="faq.html"><a href="faq.html#faq-bootstrap"><i class="fa fa-check"></i><b>A.4.5</b> Bootstrap values from newick format</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="faq.html"><a href="faq.html#branch-setting"><i class="fa fa-check"></i><b>A.5</b> Branch setting</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="faq.html"><a href="faq.html#change-branch-length-of-outgroup"><i class="fa fa-check"></i><b>A.5.1</b> Change branch length of outgroup</a></li>
<li class="chapter" data-level="A.5.2" data-path="faq.html"><a href="faq.html#bind-tip"><i class="fa fa-check"></i><b>A.5.2</b> Attach a new tip to a tree</a></li>
<li class="chapter" data-level="A.5.3" data-path="faq.html"><a href="faq.html#change-colours-or-line-types-of-arbitrary-selected-branches"><i class="fa fa-check"></i><b>A.5.3</b> Change colours or line types of arbitrary selected branches</a></li>
<li class="chapter" data-level="A.5.4" data-path="faq.html"><a href="faq.html#arbitrary-point"><i class="fa fa-check"></i><b>A.5.4</b> Add an arbitrary point to a branch</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="faq.html"><a href="faq.html#different-x-axis-labels-for-different-facet-panels"><i class="fa fa-check"></i><b>A.6</b> Different x-axis labels for different facet panels</a></li>
<li class="chapter" data-level="A.7" data-path="faq.html"><a href="faq.html#faq-under-the-tree"><i class="fa fa-check"></i><b>A.7</b> Plot something behind the phylogeny</a></li>
<li class="chapter" data-level="A.8" data-path="faq.html"><a href="faq.html#faq-enlarge-center-space"><i class="fa fa-check"></i><b>A.8</b> Enlarge center space in circular/fan layout tree</a></li>
<li class="chapter" data-level="A.9" data-path="faq.html"><a href="faq.html#use-the-most-distant-tip-from-the-root-as-the-origin-of-the-time-scale"><i class="fa fa-check"></i><b>A.9</b> Use the most distant tip from the root as the origin of the time scale</a></li>
<li class="chapter" data-level="A.10" data-path="faq.html"><a href="faq.html#export-edit"><i class="fa fa-check"></i><b>A.10</b> Edit tree graphic details</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="related-tools.html"><a href="related-tools.html"><i class="fa fa-check"></i><b>B</b> Related tools</a>
<ul>
<li class="chapter" data-level="B.1" data-path="related-tools.html"><a href="related-tools.html#rtol"><i class="fa fa-check"></i><b>B.1</b> rtol: An R interface to Open Tree API</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="ggimage-tips.html"><a href="ggimage-tips.html"><i class="fa fa-check"></i><b>C</b> Tips for using <code>ggtree</code> with <code>ggimage</code></a>
<ul>
<li class="chapter" data-level="C.1" data-path="ggimage-tips.html"><a href="ggimage-tips.html#ggimage-rm-image-bg"><i class="fa fa-check"></i><b>C.1</b> Example 1: Remove background of images</a></li>
<li class="chapter" data-level="C.2" data-path="ggimage-tips.html"><a href="ggimage-tips.html#ggimage-bgimage"><i class="fa fa-check"></i><b>C.2</b> Example 2: Plot tree on a background image</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="commicR.html"><a href="commicR.html"><i class="fa fa-check"></i><b>D</b> Comic (xkcd-like) phylogenetic tree</a></li>
<li class="chapter" data-level="E" data-path="ascii-tree.html"><a href="ascii-tree.html"><i class="fa fa-check"></i><b>E</b> Print ASCII-art rooted tree</a></li>
<li class="chapter" data-level="F" data-path="facet-zoom.html"><a href="facet-zoom.html"><i class="fa fa-check"></i><b>F</b> Zoom in selected portion</a></li>
<li class="chapter" data-level="G" data-path="run-ggtree-in-jupyter-notebook.html"><a href="run-ggtree-in-jupyter-notebook.html"><i class="fa fa-check"></i><b>G</b> Run ggtree in Jupyter notebook</a></li>
<li class="chapter" data-level="H" data-path="figures-and-tables.html"><a href="figures-and-tables.html"><i class="fa fa-check"></i><b>H</b> Figures and Tables</a></li>
<li class="chapter" data-level="I" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>I</b> Session Info</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Integration, Manipulation and Visualization of Phylogenetic Trees</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter1" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Importing Tree with Data</h1>
<div id="pc" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Overview of Phylogenetic Tree Construction</h2>
<p>Phylogenetic trees are used to describe genealogical relationships among a group of organisms, which can be constructed based on the genetic sequences of the organisms. A rooted phylogenetic tree represents a model of evolutionary history depicted by ancestor-descendant relationships between tree nodes and clustering of ‘sister’ or ‘cousin’ organisms at different level of relatedness, as illustrated in Figure <a href="chapter1.html#fig:phylogeny">1.1</a>. In infectious disease research, phylogenetic trees are usually built from the pathogens’ gene or genome sequences to show which pathogen sample is genetically closer to a pathogen sample, providing insights into the underlying unobserved epidemiologic linkage and potential source of an outbreak.</p>


<div class="figure"><span id="fig:phylogeny"></span>
<img src="treedata_files/figure-html/phylogeny-1.png" alt="Components of a phylogenetic tree. External nodes (green circles), also called ‘tips’, represent actual organisms sampled and sequenced (e.g., virus in infectious disease research). They are the ‘taxa’ in the terminology of evolutionary biology. The internal nodes (blue circles) represent hypothetical ancestors for the tips. The root (red circle) is the common ancestor of all species in the tree. The horizontal lines are branches and represent evolutionary changes (grey number) measured in unit of time or genetic divergence. The bar at the bottom provides the scale of these branch lengths." width="576"  />
<p class="caption">
Figure 1.1: <strong>Components of a phylogenetic tree.</strong> External nodes (green circles), also called ‘tips’, represent actual organisms sampled and sequenced (<em>e.g.</em>, virus in infectious disease research). They are the ‘taxa’ in the terminology of evolutionary biology. The internal nodes (blue circles) represent hypothetical ancestors for the tips. The root (red circle) is the common ancestor of all species in the tree. The horizontal lines are branches and represent evolutionary changes (grey number) measured in unit of time or genetic divergence. The bar at the bottom provides the scale of these branch lengths.
</p>
</div>
<p>Phylogenetic tree can be constructed from genetic sequences using distance-based methods or character-based methods. Distance-based methods, including unweighted pair group method with arithmetic means (UPGMA) and Neighbor-joining (NJ), are based on the matrix of pairwise genetic distances calculated between sequences. The character-based methods, including maximum parsimony (MP) <span class="citation">(Fitch <a href="#ref-fitch_toward_1971" role="doc-biblioref">1971</a>)</span>, maximum likelihood (ML) <span class="citation">(Felsenstein <a href="#ref-felsenstein_evolutionary_1981" role="doc-biblioref">1981</a>)</span>, and Bayesian Markov Chain Monte Carlo (BMCMC) method <span class="citation">(Rannala and Yang <a href="#ref-rannala_probability_1996" role="doc-biblioref">1996</a>)</span>, are based on mathematical model that describes the evolution of genetic characters and search for the best phylogenetic tree according to their own optimality criteria.</p>
<p>Maximum Parsimony (MP) method assumes that the evolutionary change is rare and minimizes the amount of character-state changes (<em>e.g.</em>, number of DNA substitutions). The criterion is similar to Occam’s razor, that the simplest hypothesis that can explains the data is the best hypothesis. Unweighted parsimony assumes mutations across different characters (nucleotides or amino acids) are equally likely while weighted method assume unequal likely of mutations (<em>e.g.</em>, the third codon position is more liable than other codon positions; and the transition mutations have higher frequency than transversion). The concept of MP method is straightforward and intuitive, which is a probable reason for its popularity amongst biologists who care more about the research question rather than the computational details of the analysis. However, this method has a number of disadvantages, which in particular the tree inference can be biased by the well-known systematic error called long-branch attraction (LBA) that incorrectly infer distantly related lineages as closely related <span class="citation">(Felsenstein <a href="#ref-felsenstein_cases_1978" role="doc-biblioref">1978</a>)</span>. This is because MP method poorly takes into consideration of many sequence evolution factors (<em>e.g.</em>, reversals and convergence) that are hardly observable from the existing genetic data.</p>
<p>Maximum likelihood (ML) method and Bayesian Markov Chain Monte Carlo (BMCMC) method are the two most commonly used methods in phylogenetic tree construction and are most often used in scientific publications. ML and BMCMC methods require a substitution model of sequence evolution. Different sequence data have different substitution models to formulate the evolutionary process of DNA, codon and amino acid. There are several models for nucleotide substitution, including JC69, K2P, F81, HKY and GTR <span class="citation">(Arenas <a href="#ref-arenas_trends_2015" role="doc-biblioref">2015</a>)</span>. These models can be used in conjunction with the rate variation across sites (denoted as +<span class="math inline">\(\Gamma\)</span>)) <span class="citation">(Yang <a href="#ref-yang_maximum_1994" role="doc-biblioref">1994</a>)</span> and the proportion of invariable sites (denoted as +I) <span class="citation">(Shoemaker and Fitch <a href="#ref-shoemaker_evidence_1989" role="doc-biblioref">1989</a>)</span>. Previous research <span class="citation">(Lemmon and Moriarty <a href="#ref-lemmon_importance_2004" role="doc-biblioref">2004</a>)</span> had suggested that misspecification of substitution model might bias phylogenetic inference. Procedural testing for the best-fit substitution model is recommended.</p>
<p>The optimal criterion of ML method is to find the tree that maximizes the likelihood given the sequence data. The procedure of ML method is simple: calculating the likelihood of a tree and optimizing its topology and branches (and the substitution model parameters, if not fixed) until the best tree is found. Heuristic search such as those implemented in <em>PhyML</em> and <em>RAxML</em>, is often used to find the best tree based on the likelihood criterion. Bayesian method finds the tree that maximizes posterior probability by sampling trees through MCMC based on the given substitution model. One of the advantage of BMCMC is that parameter variance and tree topological uncertainty, included by the posterior clade probability, can be naturally and conveniently obtained from the sampling trees in MCMC process. Moreover, influence of topological uncertainty to other parameter estimates are also naturally integrated in the BMCMC phylogenetic framework.</p>
<p>In a simple phylogenetic tree, data associated with the tree branches/nodes could be the branch lengths (indicating genetic or time divergence) and lineage supports such as bootstrap values estimated from bootstrapping procedure or posterior clade probability summarized from the sampled trees in the BMCMC analysis.</p>
</div>
<div id="format" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Phylogenetic Tree Formats</h2>
<p>There are several file formats designed to store phylogenetic trees and the data associated with the nodes and branches. The three commonly used formats are Newick<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, NEXUS <span class="citation">(Maddison et al. <a href="#ref-maddison_nexus:_1997" role="doc-biblioref">1997</a>)</span> and Phylip <span class="citation">(Felsenstein <a href="#ref-felsenstein_phylip_1989" role="doc-biblioref">1989</a>)</span>. Some formats (<em>e.g.</em>, NHX) are extended from Newick format. Newick and NEXUS formats are supported as input by most of the software in evolutionary biology, while some of the software tools output newer standard files (<em>e.g.</em>, <em>BEAST</em> and <em>MrBayes</em>) by introducing new rules/data blocks for storing evolutionary inferences. On the other cases (<em>e.g.</em>, <em>PAML</em> and <em>r8s</em>), output log files are only recognized by their own single software.</p>
<div id="newick-tree-format" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Newick tree format</h3>
<p>The Newick tree format is the standard for representing trees in computer-readable form.</p>


<div class="figure"><span id="fig:randomTree"></span>
<img src="treedata_files/figure-html/randomTree-1.png" alt="A sample tree for demonstrating Newick text to encode tree structure. Tips were aligned to right hand side and branch lengths were labelled on the middle of each branch." width="672"  />
<p class="caption">
Figure 1.2: <strong>A sample tree for demonstrating Newick text to encode tree structure.</strong> Tips were aligned to right hand side and branch lengths were labelled on the middle of each branch.
</p>
</div>
<p>The rooted tree shown in Figure <a href="chapter1.html#fig:randomTree">1.2</a> can be represented by the following sequence of characters as a newick tree text.</p>
<pre><code>((t2:0.04,t1:0.34):0.89,(t5:0.37,(t4:0.03,t3:0.67):0.9):0.59); </code></pre>
<p>The tree text ends with semicolon. Internal nodes are represented by a pair of matched parentheses. Between the parentheses are descendant nodes of that node. For instance <code>(t4:0.59, t1:0.37)</code> represents the parent node of <code>t4</code> and <code>t1</code> that are the immediate descendants. Sibling nodes are separated by comma and tips are represented by their names. A branch length (from parent node to child node) is represented by a real number after the child node and preceded by a colon. Singular data (<em>e.g.</em>, bootstrap values) associated with internal nodes or branches maybe encoded as node label and represented by the simple text/numbers before the colon.</p>
<p>Newick tree format was developed by Meacham in 1984 for the <em>PHYLIP</em> <span class="citation">(Retief <a href="#ref-retief_phylogenetic_2000" role="doc-biblioref">2000</a>)</span> package. Newick format is now the most widely used tree format and used by <em>PHYLIP</em>, <em>PAUP*</em> <span class="citation">(Wilgenbusch and Swofford <a href="#ref-wilgenbusch_inferring_2003" role="doc-biblioref">2003</a>)</span>, <em>TREE-PUZZLE</em> <span class="citation">(Schmidt et al. <a href="#ref-schmidt_tree-puzzle:_2002" role="doc-biblioref">2002</a>)</span>, <em>MrBayes</em> and many other applications. Phylip tree format contains Phylip multiple sequence alignment (MSA) with a corresponding Newick tree text that was built based on the MSA sequences in the same file.</p>
</div>
<div id="nexus-tree-format" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> NEXUS tree format</h3>
<p>The NEXUS format incorporates Newick tree text with related information organized into separated units known as <strong>blocks</strong>. A NEXUS block has the following structure:</p>
<pre><code>#NEXUS
...
BEGIN characters;
...
END;</code></pre>
<p>For example, the above example tree can be saved as a following NEXUS format:</p>
<pre><code>#NEXUS
[R-package APE, Wed Nov  9 11:46:32 2016]

BEGIN TAXA;
	DIMENSIONS NTAX = 5;
	TAXLABELS
		t5
		t4
		t1
		t2
		t3
	;
END;
BEGIN TREES;
	TRANSLATE
		1	t5,
		2	t4,
		3	t1,
		4	t2,
		5	t3
	;
	TREE * UNTITLED = [&amp;R] (1:0.89,((2:0.59,3:0.37):0.34,
	(4:0.03,5:0.67):0.9):0.04);
END;</code></pre>
<p>Comments can be placed by using square brackets. Some blocks can be recognized by most of the programs including <code>TAXA</code> (contains information of taxa), <code>DATA</code> (contains data matrix, <em>e.g.</em>, sequence alignment) and <code>TREE</code> (contains phylogenetic tree, <em>i.e.</em>, Newick tree text). Notably, blocks can be very diversed and some of them are only be recognized by one particular program. For example NEXUS file exported by <em>PAUP*</em> has a <strong>paup</strong> block which contains <em>PAUP*</em> commands, whereas <em>FigTree</em> exports NEXUS file with a <strong>figtree</strong> block that contains visualization settings. NEXUS organizes different types of data into different blocks, whereas programs that support reading NEXUS can parse some blocks they recognized and ignore those they could not. This is a good mechanism to allow different programs to use the same format without crashing when unsupported types of data are present. Notably most of the programs only support parsing <code>TAXA</code>, <code>DATA</code> and <code>TREE</code> blocks, therefore a program/platform that could generically read all kinds of data blocks from the NEXUS would be useful for phylogenetic data integration.</p>
<p>The <code>DATA</code> block is widely used to store sequence alignment. For this purpose, user can store tree and sequence data in Phylip format which are essentially Phylip multiple sequence alignment and Newick tree text respectively. It is used in Phylogeny Inference Package (<em>PHYLIP</em>).</p>
<!-- 

~~and it's also a drawback of NEXUS for most of the software can only parse the tree strucuture without support of the associated data. NEXUS is good for storing specific information for particular program, it can be used for storing annotated trees.~~

It is very difficult to share tree annotation data among different programs unless the data is a matrix which can be stored in `DATA` block. The `DATA` block is widely used to store sequence alignment. For this purpose, user can store tree in Phylip format which was used in PHYLIP package and can contains Phylip multiple sequence alignment with Newick tree text.

-->
</div>
<div id="nhxtext" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> New Hampshire eXtended format</h3>
<!-- Although NEXUS supports additional information in separated blocks, they are mostly not recognized by different software and can't share information among different programs. In order to store annotated tree,-->
<p>Newick, NEXUS and phylip are mainly designed to store phylogenetic tree and basic singular data associated with internal nodes or branches. In addition to the singular data annotation at branches and nodes (mentioned above), New Hampshire eXtended format (NHX), which is based on Newick (also called New Hampshire), was developed to introduce tags to associate multiple data fields with the tree nodes (both internal nodes and tips). Tags are placed after branch length and must be wrapped between <code>[&amp;&amp;NHX</code> and <code>]</code> which makes it possible to compatible with NEXUS format as it defined characters between <code>[</code> and <code>]</code> as comments. NHX is also the output format of <em>PHYLDOG</em> <span class="citation">(Boussau et al. <a href="#ref-boussau_genome-scale_2013" role="doc-biblioref">2013</a>)</span> and <em>RevBayes</em> <span class="citation">(Höhna et al. <a href="#ref-hohna_revbayes:_2016" role="doc-biblioref">2016</a>)</span>. A Tree Viewer (<em>ATV</em>) <span class="citation">(Zmasek and Eddy <a href="#ref-zmasek_atv:_2001" role="doc-biblioref">2001</a>)</span> is a java tool that supports displaying annotation data stored in NHX format, but this package is no more maintained.</p>
<p>Here is a sample tree from NHX definition document<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</p>
<pre><code>(((ADH2:0.1[&amp;&amp;NHX:S=human],
ADH1:0.11[&amp;&amp;NHX:S=human]):0.05[&amp;&amp;NHX:S=primates:D=Y:B=100],ADHY:0.1[&amp;&amp;NHX:S=nematode],ADHX:0.12[&amp;&amp;NHX:S=insect]):0.1[&amp;&amp;NHX:S=metazoa:D=N],
(ADH4:0.09[&amp;&amp;NHX:S=yeast],ADH3:0.13[&amp;&amp;NHX:S=yeast],
ADH2:0.12[&amp;&amp;NHX:S=yeast],ADH1:0.11[&amp;&amp;NHX:S=yeast]):0.1[&amp;&amp;NHX:S=Fungi])
[&amp;&amp;NHX:D=N];</code></pre>
</div>
<div id="jplace-format" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Jplace format</h3>
<p>In order to store the NGS short reads mapped onto a phylogenetic tree (for the purpose of metagenomic classification), Matsen proposed jplace format for such phylogenetic placements <span class="citation">(Matsen et al. <a href="#ref-matsen_format_2012" role="doc-biblioref">2012</a>)</span>. Jplace format is based on JSON and contains four keys: <code>tree</code>, <code>fields</code>, <code>placements</code>, <code>metadata</code> and <code>version</code>. The <code>tree</code> value contains tree text extended from Newick tree format by putting the edge label in brackets (if available) after branch length and putting the edge number in curly braces after edge label. The <code>fields</code> value contains header information of placement data. The value of <code>placements</code> is a list of <code>pqueries</code>. Each <code>pquery</code> contains two keys: <code>p</code> for placements and <code>n</code> for name or <code>nm</code> for names with multiplicity. The value of <code>p</code> is a list of placement for that <code>pqueries</code>.</p>
<p>Here is a jplace sample file:</p>
<pre><code>{
	&quot;tree&quot;: &quot;(((((((A:4{1},B:4{2}):6{3},C:5{4}):8{5},D:6{6}):
	3{7},E:21{8}):10{9},((F:4{10},G:12{11}):14{12},H:8{13}):
	13{14}):13{15},((I:5{16},J:2{17}):30{18},(K:11{19},
	L:11{20}):2{21}):17{22}):4{23},M:56{24});&quot;,
	&quot;placements&quot;: [
	{&quot;p&quot;:[24, -61371.300778, 0.333344, 0.000003, 0.003887], 
	 &quot;n&quot;:[&quot;AA&quot;]
	},
	{&quot;p&quot;:[[1, -61312.210786, 0.333335, 0.000001, 0.000003],
	      [2, -61322.210823, 0.333322, 0.000003, 0.000003],
	      [3, -61352.210823, 0.333322, 0.000961, 0.000003]],
	 &quot;n&quot;:[&quot;BB&quot;]
	},
	{&quot;p&quot;:[[8, -61312.229128, 0.200011, 0.000001, 0.000003],
	      [9, -61322.229179, 0.200000, 0.000003, 0.000003],
	      [10, -61342.229223, 0.199992, 0.000003, 0.000003]], 
	&quot;n&quot;:[&quot;CC&quot;]
	}
	],
	&quot;metadata&quot;: {&quot;info&quot;: &quot;a jplace sample file&quot;},
	&quot;version&quot; : 2,
	&quot;fields&quot;: [&quot;edge_num&quot;, &quot;likelihood&quot;, &quot;like_weight_ratio&quot;, 
	&quot;distal_length&quot;, &quot;pendant_length&quot;
	]
}</code></pre>
<p>Jplace is the output format of <em>pplacer</em> <span class="citation">(Frederick A. Matsen, Kodner, and Armbrust <a href="#ref-matsen_pplacer:_2010" role="doc-biblioref">2010</a>)</span> and Evolutionary Placement Algorithm (<em>EPA</em>) <span class="citation">(Berger, Krompass, and Stamatakis <a href="#ref-berger_performance_2011" role="doc-biblioref">2011</a><a href="#ref-berger_performance_2011" role="doc-biblioref">a</a>)</span>. But these two programs do not contain tools to visualize placement results. <em>Pplacer</em> provides <code>placeviz</code> to convert jplace file to phyloXML or Newick formats which can be visualized by <em>Archaeopteryx</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
</div>
<div id="software-outputs" class="section level3" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> Software outputs</h3>
<p><em>RAxML</em> <span class="citation">(Stamatakis <a href="#ref-stamatakis_raxml_2014" role="doc-biblioref">2014</a>)</span> can output Newick format by storing the bootstrap values as internal node labels. Another way that <em>RAxML</em> supported is to place bootstrap value inside square brackets and after branch length. This could not be supported by most of the software that support Newick format where square brackets will be ignored.</p>
<p><em>BEAST</em> <span class="citation">(Bouckaert et al. <a href="#ref-bouckaert_beast_2014" role="doc-biblioref">2014</a>)</span> output is based on NEXUS and it also introduce square brackets in the tree block to store evolutionary evidences inferred by <em>BEAST</em>. Inside brackets, curly braces may also incorporated if feature values have length more than 1 (<em>e.g.</em>, HPD or range of substitution rate). These brackets are placed between node and branch length (<em>i.e.</em>, after label if exists and before colon). Bracket is not defined in Newick format and is reserve character for NEXUS comment. So these information will be ignored for standard NEXUS parsers.</p>
<p>Here is a sample <code>TREE</code> block of the <em>BEAST</em> output:</p>
<pre><code>tree TREE1 = [&amp;R]
(((11[&amp;length=9.4]:9.38,14[&amp;length=6.4]:6.385096430786298)
[&amp;length=25.7]:25.43,4[&amp;length=9.1]:8.821663252749829)
[&amp;length=3.0]:3.10,(12[&amp;length=0.6]:0.56,
(10[&amp;length=1.6]:1.56,(7[&amp;length=5.2]:5.19,
((((2[&amp;length=3.3]:3.26,(1[&amp;length=1.3]:1.32,
(6[&amp;length=0.8]:0.83,13[&amp;length=0.8]:0.8311577761397366)
[&amp;length=2.4]:2.48917886025146)
[&amp;length=0.9]:0.9416178372674331)
[&amp;length=0.4]:0.49,9[&amp;length=1.7]:1.757288031101215)
[&amp;length=2.4]:2.35,8[&amp;length=2.1]:2.1125745387283246)
[&amp;length=0.2]:0.23,(3[&amp;length=3.3]:3.31,
(15[&amp;length=5.2]:5.27,5[&amp;length=3.2]:3.2710481368304585)
[&amp;length=1.0]:1.0409443024626412)
[&amp;length=1.9]:2.0372962536780435)
[&amp;length=2.8]:2.8446835614595685)
[&amp;length=5.3]:5.367459711197171)
[&amp;length=2.0]:2.0037467863383043)
[&amp;length=4.3]:4.360909907798238)[&amp;length=0.0];</code></pre>
<p><em>BEAST</em> output can contain many different evolutionary inferences, depending of the analysis models defined in <em>BEAUTi</em> for running. For example in molecular clock analysis, it contains <code>rate</code>, <code>length</code>, <code>height</code>, <code>posterior</code> and corresponding HPD and range for uncertainty estimation. <code>Rate</code> is the estimated evolutionary rate of the branch. <code>Length</code> is the length of the branch in years. <code>Height</code> is the time from node to root while <code>posterior</code> is the Bayesian clade credibility value. The above example is the output tree of clock analysis and should contains these inferences. To save space, I only keep the <code>length</code> above.</p>
<p><em>MrBayes</em> <span class="citation">(Huelsenbeck and Ronquist <a href="#ref-huelsenbeck_mrbayes_2001" role="doc-biblioref">2001</a>)</span> is a program that uses Markov Chain Monte Carlo method to sample from the posterior probability distributions. Its output file annotates nodes and branches separately by two sets of square brackets. For example below, posterior clade probabilities for the node and branch length estimates for the branch:</p>
<pre><code>tree con_all_compat = [&amp;U]
(8[&amp;prob=1.0]:2.94e-1[&amp;length_mean=2.9e-1],10[&amp;prob=1.0]:2.25e-1[&amp;length_mean=2.2e-1],
((((1[&amp;prob=1.0]:1.43e-1[&amp;length_mean=1.4e-1],2[&amp;prob=1.0]:1.92e-1[&amp;length_mean=1.9e-1])
[&amp;prob=1.0]:1.24e-1[&amp;length_mean=1.2e-1],9[&amp;prob=1.0]:2.27e-1[&amp;length_mean=2.2e-1])
[&amp;prob=1.0]:1.72e-1[&amp;length_mean=1.7e-1],12[&amp;prob=1.0]:5.11e-1[&amp;length_mean=5.1e-1])
[&amp;prob=1.0]:1.76e-1[&amp;length_mean=1.7e-1],
(((3[&amp;prob=1.0]:5.46e-2[&amp;length_mean=5.4e-2],
(6[&amp;prob=1.0]:1.03e-2[&amp;length_mean=1.0e-2],7[&amp;prob=1.0]:7.13e-3[&amp;length_mean=7.2e-3])
[&amp;prob=1.0]:6.93e-2[&amp;length_mean=6.9e-2])
[&amp;prob=1.0]:6.03e-2[&amp;length_mean=6.0e-2],
(4[&amp;prob=1.0]:6.27e-2[&amp;length_mean=6.2e-2],5[&amp;prob=1.0]:6.31e-2[&amp;length_mean=6.3e-2])
[&amp;prob=1.0]:6.07e-2[&amp;length_mean=6.0e-2])
[&amp;prob=1.0]:1.80e-1[&amp;length_mean=1.8e-1],11[&amp;prob=1.0]:2.37e-1[&amp;length_mean=2.3e-1])
[&amp;prob=1.0]:4.05e-1[&amp;length_mean=4.0e-1])
[&amp;prob=1.0]:1.16e+000[&amp;length_mean=1.162699558201079e+000])
[&amp;prob=1.0][&amp;length_mean=0];</code></pre>
<p>To save space, most of the inferences were removed and only contains <code>prob</code> for clade probability and <code>length_mean</code> for mean value of branch length. The full version of this file also contains <code>prob_stddev</code>, <code>prob_range</code>, <code>prob(percent)</code>, <code>prob+-sd</code> for probability inferences and <code>length_median</code>, <code>length_95%_HPD</code> for every branch.</p>
<p>The <em>BEAST</em> and <em>MrBayes</em> outputs are expected to be parsed without inferences (dropped as comments) by software that support NEXUS. <em>FigTree</em> supports parsing <em>BEAST</em> and <em>MrBayes</em> outputs with inferences that can be used to display or annotate on the tree. But from there extracting these data for further analysis is still challenging.</p>
<p><em>HyPhy</em> <span class="citation">(Pond, Frost, and Muse <a href="#ref-pond_hyphy:_2005" role="doc-biblioref">2005</a>)</span> could do a number of phylogenetic analysis, including ancestral sequence reconstruction. For ancestral sequence reconstruction, these sequences and the Newick tree text are stored in NEXUS format as the major analysis output. It did not completely follow the NEXUS definition and only put the ancestral node labels in <code>TAXA</code> instead of external node label. The <code>MATRIX</code> block contains sequence alignment of ancestral nodes which cannot be referred back to the tree stored in <code>TREES</code> block since it does not contains node labels. Here is the sample output (to save space, only the first 72bp of alignment are shown):</p>
<pre><code>#NEXUS

[
Generated by HYPHY 2.0020110620beta(MP) for MacOS(Universal Binary) 
	on Tue Dec 23 13:52:34 2014

]

BEGIN TAXA;
	DIMENSIONS NTAX = 13;
	TAXLABELS
		&#39;Node1&#39; &#39;Node2&#39; &#39;Node3&#39; &#39;Node4&#39; &#39;Node5&#39; &#39;Node12&#39; &#39;Node13&#39; &#39;Node15&#39;
			&#39;Node18&#39; &#39;Node20&#39; &#39;Node22&#39; &#39;Node24&#39; &#39;Node26&#39; ;
END;

BEGIN CHARACTERS;
	DIMENSIONS NCHAR = 2148;
	FORMAT
		DATATYPE = DNA

		GAP=-
		MISSING=?
		NOLABELS
	;

MATRIX
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATTGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAATGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
 ATGGAAGACTTTGTGCGACAGTGCTTCAATCCAATGATCGTCGAGCTTGCGGAAAAGGCAATGAAAGAATAT
END;

BEGIN TREES;
	TREE tree = (K,N,(D,(L,(J,(G,((C,(E,O)),(H,(I,(B,(A,(F,M)))))))))));
END;</code></pre>
<p>There are other applications that output rich information text that also contains phylogenetic trees with associated data. For example <em>r8s</em> <span class="citation">(Sanderson <a href="#ref-sanderson_r8s:_2003" role="doc-biblioref">2003</a>)</span> output three trees in its log file, namely <code>TREE</code>, <code>RATE</code> and <code>PHYLO</code> for branches scaled by time, substitution rate, and absolute substitutions respectively.</p>
<p>Phylogenetic Analysis by Maximum Likelihood (<em>PAML</em>) <span class="citation">(Yang <a href="#ref-yang_paml_2007" role="doc-biblioref">2007</a>)</span> is a package of programs for phylogenetic analyses of DNA or protein sequences. Two main programs, <em>BaseML</em> and <em>CodeML</em>, implement a variety of models. <em>BaseML</em> estimates tree topology, branch lengths and substitution parameters using a number of nucleotide substitution models available, including JC69, K80, F81, F84, HKY85, T92, TN93 and GTR. <em>CodeML</em> estimates synonymous and non-synonymous substitution rates, likelihood ratio test of positive selection under codon substitution models <span class="citation">(Goldman and Yang <a href="#ref-goldman_codon-based_1994" role="doc-biblioref">1994</a>)</span>.</p>
<p><em>BaseML</em> outputs <em>mlb</em> file that contains input sequence (taxa) alignment and phylogenetic tree with branch length as well as substitution model and other parameters estimated. The supplementary result file, <em>rst</em>, contains sequence alignment (with ancestral sequence if perform reconstruction of ancestral sequences) and Naive Empirical Bayes (NBE) probabilities that each site in the alignment evolved. <em>CodeML</em> outputs <em>mlc</em> file that contains tree structure and estimation of synonymous and non-synonymous substitution rates. <em>CodeML</em> also output supplementary result file, <em>rst</em>, that is similar to <em>BaseML</em> except that site is defined as codon instead of nucleotide. Parsing these files can be tedious and would oftentimes need a number of post-processing steps and require expertise in programming (e.g. with Python<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> or Perl<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>).</p>
<p>Introducing square brackets is quite common for storing extra information, including <em>RAxML</em> to store bootstrap value, NHX format for annotation, jplace for edge label and <em>BEAST</em> for evolutionary estimation, <em>etc.</em>. But the positions to place square brackets are not consistent in different software and the contents employ different rules for storing associated data, these properties make it difficult to parse associated data. For most of the software, they will just ignore square brackets and only parse the tree structure if the file is compatible. Some of them contains invalid characters (e.g. curly braces in <code>tree</code> field of jplace format) and even the tree structure can’t be parsed by standard parsers.</p>
<p>It is difficult to extract useful phylogeny/taxon-related information from the different analysis outputs produced by various evolutionary inference software, for displaying on the same phylogenetic tree and for further analysis. <em>FigTree</em> supports <em>BEAST</em> output, but not for most of other software outputs that contains evolutionary inferences or associated data. For those output rich text files (e.g. <em>r8s</em>, <em>PAML</em>, <em>etc.</em>), the tree structure cannot be parsed by any tree viewing software and users need expertise to manually extract the phylogenetic tree and other useful result data from the output file. However, such manual operation is slow and error-prone.</p>
<!-- can't be supported and hard to display on the tree. A very common solution is to modified node labels by putting associated data to node labels and dispaly them as node lables. This is quite restricted and error prone.-->
<p>It was not easy to retrieve phylogenetic trees with evolutionary data from different analysis outputs of commonly used software in the field. Some of them (<em>e.g.</em>, <em>PAML</em> output and jplace file) without software or programming library to support parsing file, while others (<em>e.g.</em>, <em>BEAST</em> and <em>MrBayes</em> output) can be parsed without evolutionary inferences as they are stored in square brackets that will be omitted as comment by most of the software. Although <em>FigTree</em> support visualizing evolutionary statistics inferred by <em>BEAST</em> and <em>MrBayes</em>, extracting these data for further analysis is not supported. Different software packages implement different algorithms for different analyses (<em>e.g.</em>, <em>PAML</em> for <em>d<sub>N</sub>/d<sub>S</sub></em>, <em>HyPhy</em> for ancestral sequences and <em>BEAST</em> for skyline analysis). Therefore, in encountering the genomic sequence data, there is a desire need to efficiently and flexibly integrate different analysis inference results for comprehensive understanding, comparison and further analysis. This motivated us to develop the programming library to parse the phylogenetic trees and data from various sources.</p>
<!--
to complete each other or compare similar analyses from different software (*e.g.*, clade probability inferred from `BEAST` and `MrBayes`). Without programming library to parse these software outputs make it difficult to integrate evolutionary statistics for comparison and further analysis.
-->
</div>
</div>
<div id="getting-tree-data-with-treeio" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Getting Tree Data with <em>treeio</em></h2>
<p>Phylogenetic trees are commonly used to present evolutionary relationships of
species. Information associated with taxon species/strains may be further
analyzed in the context of the evolutionary history depicted by the phylogenetic
tree. For example, host information of the influenza virus strains in the tree
could be studied to understand host range of a virus linage. Moreover, such
meta-data (<em>e.g.</em>, isolation host, time, location, <em>etc.</em>) directly associated
with taxon strains are also often subjected to further evolutionary or
comparative phylogenetic models and analyses, to infer their dynamics associated
with the evolutionary or transmission processes of the virus. All these
meta-data or other phenotypic or experimental data are stored either as the
annotation data associated with the nodes or branches, and are often produced in
inconsistent format by different analysis programs.</p>
<p>Getting trees into R is still limited. Newick and Nexus can be imported by
several packages, including <a href="https://CRAN.R-project.org/package=ape">ape</a>, <a href="https://CRAN.R-project.org/package=phylobase">phylobase</a>. NeXML
format can be parsed by <a href="https://CRAN.R-project.org/package=RNeXML">RNeXML</a>. However, analysis results from
widely used software packages in this field are not well
supported. SIMMAP output can be parsed by <a href="https://CRAN.R-project.org/package=phyext2">phyext2</a> and <a href="https://CRAN.R-project.org/package=phytools">phytools</a>.
Although <a href="http://www.christophheibl.de/Rpackages.html">PHYLOCH</a> can
import <em>BEAST</em> and <em>MrBayes</em> output, only internal node attributes were parsed and
tip attributes were ignore<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. Many other software outputs are mainly required
programming expertise to import the tree with associated data. Linking external
data, including experimental and clinical data, to phylogeny is another obstacle
for evolution biologists.</p>
<p>To fill the gap that most of the tree formats or software outputs cannot be parsed within the same software/platform, an R package <em>treeio</em> was developed for parsing various tree file formats and outputs from common evolutionary analysis software. <em>Treeio</em> is developed with the R programming language <span class="citation">(R Core Team <a href="#ref-rstats" role="doc-biblioref">2016</a>)</span>. Not only the tree structure can be parsed but also the associated data and evolutionary inferences, including NHX
annotation, clock rate inferences (from <a href="http://beast2.org/">BEAST</a>
or <a href="http://ginger.ucdavis.edu/r8s">r8s</a> <span class="citation">(Sanderson <a href="#ref-sanderson_r8s:_2003" role="doc-biblioref">2003</a>)</span> programs),
snynonymous and non-synonymous substitutions (from CodeML), and ancestral
sequence construction (from
<a href="https://veg.github.io/hyphy-site/">HyPhy</a>,
<a href="http://abacus.gene.ucl.ac.uk/software/paml.html">BaseML</a>
or <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CodeML</a>), <em>etc.</em>.
Currently, <a href="https://bioconductor.org/packages/treeio/">treeio</a> is able to read
the following file formats: Newick, Nexus, New Hampshire eXtended format (NHX),
jplace and Phylip as well as the data outputs from the following analysis programs:
<a href="https://github.com/smirarab/ASTRAL">ASTRAL</a>,
<a href="http://beast2.org/">BEAST</a>,
<a href="http://sco.h-its.org/exelixis/web/software/epa/index.html">EPA</a>,
<a href="https://veg.github.io/hyphy-site/">HyPhy</a>,
<a href="https://www.megasoftware.net/">MEGA</a>,
<a href="http://nbisweden.github.io/MrBayes/">MrBayes</a>,
<a href="http://abacus.gene.ucl.ac.uk/software/paml.html">PAML</a>,
<a href="https://pbil.univ-lyon1.fr/software/phyldog/">PHYLDOG</a>,
<a href="http://matsen.fhcrc.org/pplacer/">pplacer</a>,
<a href="http://ginger.ucdavis.edu/r8s">r8s</a>,
<a href="http://evomics.org/learning/phylogenetics/raxml/">RAxML</a> and
<a href="https://revbayes.github.io/intro.html">RevBayes</a> <em>etc</em>. This is made possible with the several parser functions developed in <em>treeio</em> (Table <a href="chapter1.html#tab:treeio-function">1.1</a>)<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<table>
<caption>
<span id="tab:treeio-function">Table 1.1: </span>Parser functions defined in treeio
</caption>
<thead>
<tr>
<th style="text-align:left;">
Parser function
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
read.astral
</td>
<td style="text-align:left;">
parsing output of ASTRAL
</td>
</tr>
<tr>
<td style="text-align:left;">
read.beast
</td>
<td style="text-align:left;">
parsing output of BEAST
</td>
</tr>
<tr>
<td style="text-align:left;">
read.codeml
</td>
<td style="text-align:left;">
parsing output of CodeML (rst and mlc files)
</td>
</tr>
<tr>
<td style="text-align:left;">
read.codeml_mlc
</td>
<td style="text-align:left;">
parsing mlc file (output of CodeML)
</td>
</tr>
<tr>
<td style="text-align:left;">
read.fasta
</td>
<td style="text-align:left;">
parsing FASTA format sequence file
</td>
</tr>
<tr>
<td style="text-align:left;">
read.hyphy
</td>
<td style="text-align:left;">
parsing output of HYPHY
</td>
</tr>
<tr>
<td style="text-align:left;">
read.hyphy.seq
</td>
<td style="text-align:left;">
parsing ancestral sequences from HYPHY output
</td>
</tr>
<tr>
<td style="text-align:left;">
read.iqtree
</td>
<td style="text-align:left;">
parsing IQ-Tree newick string, with ability to parse SH-aLRT and UFBoot support values
</td>
</tr>
<tr>
<td style="text-align:left;">
read.jplace
</td>
<td style="text-align:left;">
parsing jplace file including output of EPA and pplacer
</td>
</tr>
<tr>
<td style="text-align:left;">
read.jtree
</td>
<td style="text-align:left;">
parsing <a href="chapter3.html#write-jtree">jtree</a> format
</td>
</tr>
<tr>
<td style="text-align:left;">
read.mega
</td>
<td style="text-align:left;">
parsing MEGA Nexus output
</td>
</tr>
<tr>
<td style="text-align:left;">
read.mega_tabular
</td>
<td style="text-align:left;">
parsing MEGA tabular output
</td>
</tr>
<tr>
<td style="text-align:left;">
read.mrbayes
</td>
<td style="text-align:left;">
parsing output of MrBayes
</td>
</tr>
<tr>
<td style="text-align:left;">
read.newick
</td>
<td style="text-align:left;">
parsing newick string, with ability to parse node label as support values
</td>
</tr>
<tr>
<td style="text-align:left;">
read.nhx
</td>
<td style="text-align:left;">
parsing NHX file including output of PHYLDOG and RevBayes
</td>
</tr>
<tr>
<td style="text-align:left;">
read.paml_rst
</td>
<td style="text-align:left;">
parsing rst file (output of BaseML or CodeML)
</td>
</tr>
<tr>
<td style="text-align:left;">
read.phylip
</td>
<td style="text-align:left;">
parsing phylip file (phylip alignment + newick string)
</td>
</tr>
<tr>
<td style="text-align:left;">
read.phylip.seq
</td>
<td style="text-align:left;">
parsing multiple sequence alignment from phylip file
</td>
</tr>
<tr>
<td style="text-align:left;">
read.phylip.tree
</td>
<td style="text-align:left;">
parsing newick string from phylip file
</td>
</tr>
<tr>
<td style="text-align:left;">
read.r8s
</td>
<td style="text-align:left;">
parsing output of r8s
</td>
</tr>
<tr>
<td style="text-align:left;">
read.raxml
</td>
<td style="text-align:left;">
parsing output of RAxML
</td>
</tr>
</tbody>
</table>
<p>The <a href="https://bioconductor.org/packages/treeio/">treeio</a> package defines base
classes and functions for phylogenetic tree input and output. It is an
infrastructure that enables evolutionary evidences that inferred by commonly
used software packages to be used in <code>R</code>. For instance, <em>d<sub>N</sub>/d<sub>S</sub></em> values or
ancestral sequences inferred
by <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CODEML</a> <span class="citation">(Yang <a href="#ref-yang_paml_2007" role="doc-biblioref">2007</a>)</span>,
clade support values (posterior) inferred
by <a href="http://beast2.org/">BEAST</a> <span class="citation">(Bouckaert et al. <a href="#ref-bouckaert_beast_2014" role="doc-biblioref">2014</a>)</span> and short read placement
by
<a href="http://sco.h-its.org/exelixis/web/software/epa/index.html">EPA</a> <span class="citation">(Berger, Krompass, and Stamatakis <a href="#ref-berger_EPA_2011" role="doc-biblioref">2011</a><a href="#ref-berger_EPA_2011" role="doc-biblioref">b</a>)</span>
and <a href="http://matsen.fhcrc.org/pplacer/">pplacer</a> <span class="citation">(Frederick A Matsen, Kodner, and Armbrust <a href="#ref-matsen_pplacer_2010" role="doc-biblioref">2010</a>)</span>. These
evolutionary evidences can be further analyzed in <code>R</code> and used to annotate
phylogenetic tree using <a href="https://bioconductor.org/packages/ggtree/">ggtree</a>
<span class="citation">(Yu et al. <a href="#ref-yu_ggtree:_2017" role="doc-biblioref">2017</a>)</span>. The growth of analysis tools and models available introduces
a challenge to integrate different varieties of data and analysis results from
different sources for an integral analysis on the the same phylogenetic tree
background. The <a href="https://bioconductor.org/packages/treeio/">treeio</a> package
provides a <code>merge_tree</code> function to allow <a href="chapter2.html#merge-tree">combining tree data</a> obtained from
different sources. In addition, <a href="https://bioconductor.org/packages/treeio/">treeio</a> also enables <a href="chapter2.html#link-external-data">external data</a> to be linked to phylogenetic tree structure.</p>
<p>After parsing, storage of the tree structure with associated data is made
through a S4 class, <code>treedata</code>, defined in the <a href="https://CRAN.R-project.org/package=tidytree">tidytree</a> package. These parsed data
are mapped to the tree branches and nodes inside <code>treedata</code> object, so that they
can be efficiently used to visually annotate the tree
using <a href="https://bioconductor.org/packages/ggtree/">ggtree</a> package <span class="citation">(Yu et al. <a href="#ref-yu_ggtree:_2017" role="doc-biblioref">2017</a>)</span> (described in Chapter <a href="chapter4.html#chapter4">4</a> and <a href="chapter5.html#chapter5">5</a>).
A programmable platform for phylogenetic data parsing, integration and annotations as such makes us easier to identify the evolutionary dynamics and correlation patterns.</p>
<div id="overview-of-treeio" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Overview of <em>treeio</em></h3>
<p>The <a href="http://bioconductor.org/packages/treeio">treeio</a> package defined <code>S4</code> classes for storing phylogenetic tree with diverse types of associated data or covariates from different sources including analysis outputs from different software packages. It also defined corresponding parser functions for parsing phylogenetic tree with annotation data and stored as data object in R for further manipulation or analysis (see Table <a href="chapter1.html#tab:treeio-function">1.1</a>). Several accessor functions were defined to facilitate accessing the tree annotation data, including <code>get.fields</code> for obtaining annotation features available in the tree object, <code>get.placements</code> for obtaining the phylogenetic placement results (<em>i.e.</em>, output of <em>pplacer</em>, <em>EPA</em>, <em>etc.</em>), <code>get.subs</code> for obtaining the genetic substitutions from parent node to child node, and <code>get.tipseq</code> for getting the tip sequences.</p>
<p>The <code>S3</code> class, <code>phylo</code>, which was defined in <em>ape</em> <span class="citation">(Paradis, Claude, and Strimmer <a href="#ref-paradis_ape_2004" role="doc-biblioref">2004</a>)</span> package, is widely used in <code>R</code> community and many packages. As <em>treeio</em> uses <code>S4</code> class, to enable those available R packages to analyze the tree imported by <em>treeio</em>, <em>treeio</em> provides <code>as.phylo</code> function to convert <em>treeio</em>-generated tree object to <code>phylo</code> object that only contains tree structure without annotation data. In the other way, <em>treeio</em> also provides <code>as.treedata</code> function to convert <code>phylo</code> object with evolutionary analysis result (<em>e.g.</em>, bootstrap values calculated by <em>ape</em> or ancestral states inferred by <em>phangorn</em> <span class="citation">(Schliep <a href="#ref-schliep_phangorn_2011" role="doc-biblioref">2011</a>)</span> <em>etc</em>) to be stored as a <code>treedata</code> <code>S4</code> object, making it easy to map the data to the tree structure and to be visualized using <a href="http://bioconductor.org/packages/ggtree">ggtree</a>.</p>
<!--
(*e.g.*, `phangorn`  for ancestral state reconstruction and `ape` for divergence time estimation) that implemented evolutionary inferences are supporting `phylo` object. 
-->
<p>To allow integration of different kinds of data in phylogenetic tree, <em>treeio</em> provides <code>merge_tree</code> function (details in section <a href="chapter2.html#merge-tree">2.2.1</a>) for combining evolutionary statistics/evidences imported from different sources including those common tree files and outputs from analysis programs (Table <a href="chapter1.html#tab:treeio-function">1.1</a>). There are other information, such as sampling location, taxonomy information, experimental result and evolutionary traits, <em>etc.</em> that are stored in separate files with user-defined format. In <a href="http://bioconductor.org/packages/treeio">treeio</a>, we could read in these data from the users’ files using standard R <em>IO</em> functions, and attach them to the tree object by the <a href="chapter2.html#link-external-data">full_join</a> method defined in our <a href="http://bioconductor.org/packages/treeio">treeio</a> package (see also the <a href="chapter7.html#attach-operator"><code>%&lt;+%</code> operator</a> defined in <a href="http://bioconductor.org/packages/ggtree">ggtree</a>). After attaching, the data will become the attributes associated with nodes or branches, which can be compared with other data incorporated, or can be visually displayed on the tree.</p>
<p>To facilitate storing the merged data into a single file, <a href="http://bioconductor.org/packages/treeio">treeio</a> implemented <code>write.baset</code> and <code>write.jtree</code> function to export treedata object for storing complex data associated with the phylogenetic tree (see <a href="chapter3.html#chapter3">Chapter 3</a>).</p>
<!-- A full list of functions that defined in *treeio* can be found in Table \@ref(tab:treeio). -->
</div>
<div id="function-demonstration" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Function Demonstration</h3>
<div id="parsing-beast-output" class="section level4" number="1.3.2.1">
<h4><span class="header-section-number">1.3.2.1</span> Parsing BEAST output</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter1.html#cb9-1" aria-hidden="true"></a>file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/BEAST&quot;</span>, <span class="st">&quot;beast_mcc.tree&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb9-2"><a href="chapter1.html#cb9-2" aria-hidden="true"></a>beast &lt;-<span class="st"> </span><span class="kw">read.beast</span>(file)</span>
<span id="cb9-3"><a href="chapter1.html#cb9-3" aria-hidden="true"></a>beast</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/BEAST/beast_mcc.tree&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 14 internal nodes.
## 
## Tip labels:
## 	A_1995, B_1996, C_1995, D_1987, E_1996, F_1997, ...
## 
## Rooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;height&#39;,	&#39;height_0.95_HPD&#39;,	&#39;height_median&#39;,
## 	&#39;height_range&#39;,	&#39;length&#39;,	&#39;length_0.95_HPD&#39;,
## 	&#39;length_median&#39;,	&#39;length_range&#39;,	&#39;posterior&#39;,	&#39;rate&#39;,
## 	&#39;rate_0.95_HPD&#39;,	&#39;rate_median&#39;,	&#39;rate_range&#39;.</code></pre>
<p>Since <em><code>%</code></em> is not a valid character in <em><code>names</code></em>, all the feature names that contain <em><code>x%</code></em> will convert to <em><code>0.x</code></em>. For example, <em><code>length_95%_HPD</code></em> will be changed to <em><code>length_0.95_HPD</code></em>.</p>
<p>Not only tree structure but also all the features inferred by <em>BEAST</em> will be stored in the <code>S4</code> object. These features can be used for tree annotation (Figure <a href="chapter5.html#fig:beast">5.7</a>).</p>
</div>
<div id="mega" class="section level4" number="1.3.2.2">
<h4><span class="header-section-number">1.3.2.2</span> Parsing MEGA output</h4>
<p><a href="https://www.megasoftware.net/">MEGA</a> <span class="citation">(Kumar, Stecher, and Tamura <a href="#ref-kumar_mega7_2016" role="doc-biblioref">2016</a>)</span> supports exporting trees in three distinct formats: Newick, tabular and Nexus. The Newick file can be parsed using the <code>read.tree</code> or <code>read.newick</code> functions. MEGA Nexus file is similar to BEAST Nexus and <a href="http://bioconductor.org/packages/treeio">treeio</a> provides <code>read.mega</code> function to parse the tree.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapter1.html#cb11-1" aria-hidden="true"></a>file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/MEGA7&quot;</span>, <span class="st">&quot;mtCDNA_timetree.nex&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb11-2"><a href="chapter1.html#cb11-2" aria-hidden="true"></a><span class="kw">read.mega</span>(file)</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/MEGA7/mtCDNA_timetree.nex&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 7 tips and 6 internal nodes.
## 
## Tip labels:
## 	homo_sapiens, chimpanzee, bonobo, gorilla, orangutan, sumatran, ...
## 
## Rooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;branch_length&#39;,	&#39;data_coverage&#39;,	&#39;rate&#39;,	&#39;reltime&#39;,
## 	&#39;reltime_0.95_CI&#39;,	&#39;reltime_stderr&#39;.</code></pre>
<p>The tabular output contains tree and associated information (divergence time in this example) in a tabular flat text file. The <code>read.mega_tabular</code> function can parse the tree with data simultaneously.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter1.html#cb13-1" aria-hidden="true"></a>file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/MEGA7&quot;</span>, <span class="st">&quot;mtCDNA_timetree_tabular.txt&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb13-2"><a href="chapter1.html#cb13-2" aria-hidden="true"></a><span class="kw">read.mega_tabular</span>(file) </span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/MEGA7/mtCDNA_timetree_tabular.txt&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 7 tips and 6 internal nodes.
## 
## Tip labels:
## 	chimpanzee, bonobo, homo sapiens, gorilla, orangutan, sumatran, ...
## Node labels:
## [1] &quot;&quot;           &quot;&quot;           &quot;demoLabel2&quot; &quot;&quot;          
## [5] &quot;&quot;           &quot;&quot;          
## 
## Rooted; no branch lengths.
## 
## with the following features available:
## 	&#39;RelTime&#39;,	&#39;CI_Lower&#39;,	&#39;CI_Upper&#39;,	&#39;Rate&#39;,
## 	&#39;Data Coverage&#39;.</code></pre>
</div>
<div id="parsing-mrbayes-output" class="section level4" number="1.3.2.3">
<h4><span class="header-section-number">1.3.2.3</span> Parsing MrBayes output</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter1.html#cb15-1" aria-hidden="true"></a>file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/MrBayes&quot;</span>, <span class="st">&quot;Gq_nxs.tre&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb15-2"><a href="chapter1.html#cb15-2" aria-hidden="true"></a><span class="kw">read.mrbayes</span>(file)</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/MrBayes/Gq_nxs.tre&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 12 tips and 10 internal nodes.
## 
## Tip labels:
## 	B_h, B_s, G_d, G_k, G_q, G_s, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;length_0.95HPD&#39;,	&#39;length_mean&#39;,	&#39;length_median&#39;,	&#39;prob&#39;,
## 	&#39;prob_range&#39;,	&#39;prob_stddev&#39;,	&#39;prob_percent&#39;,	&#39;prob+-sd&#39;.</code></pre>
</div>
<div id="parsing-paml-output" class="section level4" number="1.3.2.4">
<h4><span class="header-section-number">1.3.2.4</span> Parsing PAML output</h4>
<p>The <code>read.paml_rst</code> function can parse <em>rst</em> file
from <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">BASEML</a>
and <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CODEML</a>. The only
difference is the space in the sequences.
For <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">BASEML</a>, each ten bases
are separated by one space, while
for <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CODEML</a>, each three bases
(triplet) are separated by one space.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter1.html#cb17-1" aria-hidden="true"></a>brstfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/PAML_Baseml&quot;</span>, <span class="st">&quot;rst&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb17-2"><a href="chapter1.html#cb17-2" aria-hidden="true"></a>brst &lt;-<span class="st"> </span><span class="kw">read.paml_rst</span>(brstfile)</span>
<span id="cb17-3"><a href="chapter1.html#cb17-3" aria-hidden="true"></a>brst</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/PAML_Baseml/rst&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
## 	A, B, C, D, E, F, ...
## Node labels:
## 	16, 17, 18, 19, 20, 21, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;subs&#39;,	&#39;AA_subs&#39;.</code></pre>
<p>Similarly, we can parse the <em>rst</em> file from <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CODEML</a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter1.html#cb19-1" aria-hidden="true"></a>crstfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/PAML_Codeml&quot;</span>, <span class="st">&quot;rst&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb19-2"><a href="chapter1.html#cb19-2" aria-hidden="true"></a><span class="co">## type can be one of &quot;Marginal&quot; or &quot;Joint&quot;</span></span>
<span id="cb19-3"><a href="chapter1.html#cb19-3" aria-hidden="true"></a>crst &lt;-<span class="st"> </span><span class="kw">read.paml_rst</span>(crstfile, <span class="dt">type =</span> <span class="st">&quot;Joint&quot;</span>)</span>
<span id="cb19-4"><a href="chapter1.html#cb19-4" aria-hidden="true"></a>crst</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/PAML_Codeml/rst&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
## 	A, B, C, D, E, F, ...
## Node labels:
## 	16, 17, 18, 19, 20, 21, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;subs&#39;,	&#39;AA_subs&#39;.</code></pre>
<p>Ancestral sequences inferred by <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">BASEML</a>
or <a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CODEML</a> via marginal or
joint ML reconstruction methods will be stored in the S4 object and mapped to
tree nodes. <a href="https://bioconductor.org/packages/treeio/">treeio</a> will automatically determine the substitutions between the
sequences at the both ends of each branch. Amino acid substitution will also be
determined by translating nucleotide sequences to amino acid sequences. These
computed substitutions will also be stored in the S4 object for efficient tree annotation later (Figure <a href="chapter5.html#fig:codeml">5.9</a>).</p>
<p><a href="http://abacus.gene.ucl.ac.uk/software/paml.html">CODEML</a> infers selection
pressure and estimated <em>d<sub>N</sub>/d<sub>S</sub></em>, <em>d<sub>N</sub></em> and <em>d<sub>S</sub></em>. These information are
stored in output file <em>mlc</em>, which can be parsed by <code>read.codeml_mlc</code> function.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter1.html#cb21-1" aria-hidden="true"></a>mlcfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/PAML_Codeml&quot;</span>, <span class="st">&quot;mlc&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb21-2"><a href="chapter1.html#cb21-2" aria-hidden="true"></a>mlc &lt;-<span class="st"> </span><span class="kw">read.codeml_mlc</span>(mlcfile)</span>
<span id="cb21-3"><a href="chapter1.html#cb21-3" aria-hidden="true"></a>mlc</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/PAML_Codeml/mlc&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
## 	A, B, C, D, E, F, ...
## Node labels:
## 	16, 17, 18, 19, 20, 21, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;t&#39;,	&#39;N&#39;,	&#39;S&#39;,	&#39;dN_vs_dS&#39;,	&#39;dN&#39;,	&#39;dS&#39;,	&#39;N_x_dN&#39;,	&#39;S_x_dS&#39;.</code></pre>
<p>In previous session, we separately parsed <em>rst</em> and <em>mlc</em> files. However, they
can also be parsed together using <code>read.codeml</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter1.html#cb23-1" aria-hidden="true"></a><span class="co">## tree can be one of &quot;rst&quot; or &quot;mlc&quot; to specify</span></span>
<span id="cb23-2"><a href="chapter1.html#cb23-2" aria-hidden="true"></a><span class="co">## using tree from which file as base tree in the object</span></span>
<span id="cb23-3"><a href="chapter1.html#cb23-3" aria-hidden="true"></a>ml &lt;-<span class="st"> </span><span class="kw">read.codeml</span>(crstfile, mlcfile, <span class="dt">tree =</span> <span class="st">&quot;mlc&quot;</span>)</span>
<span id="cb23-4"><a href="chapter1.html#cb23-4" aria-hidden="true"></a>ml</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/PAML_Codeml/rst&#39;,
## 	&#39;/home/ygc/R/library/treeio/extdata/PAML_Codeml/mlc&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
## 	A, B, C, D, E, F, ...
## Node labels:
## 	16, 17, 18, 19, 20, 21, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;subs&#39;,	&#39;AA_subs&#39;,	&#39;t&#39;,	&#39;N&#39;,	&#39;S&#39;,	&#39;dN_vs_dS&#39;,	&#39;dN&#39;,	&#39;dS&#39;,
## 	&#39;N_x_dN&#39;,	&#39;S_x_dS&#39;.</code></pre>
<p>All the features in both <em>rst</em> and <em>mlc</em> files were imported into a single S4
object and hence are available for further annotation and visualization. For
example, we can annotate and display both <em>d<sub>N</sub>/d<sub>S</sub></em> (from <em>mlc</em> file) and
amino acid substitutions (derived from <em>rst</em> file) on the same phylogenetic tree <span class="citation">(Yu et al. <a href="#ref-yu_ggtree:_2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<div id="parsing-hyphy-output" class="section level4" number="1.3.2.5">
<h4><span class="header-section-number">1.3.2.5</span> Parsing HyPhy output</h4>
<p>Ancestral sequences inferred by <a href="https://veg.github.io/hyphy-site/">HyPhy</a> are
stored in the Nexus output file, which contains the tree topology and ancestral
sequences. To parse this data file, users can use the <code>read.hyphy.seq</code> function.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter1.html#cb25-1" aria-hidden="true"></a>ancseq &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/HYPHY&quot;</span>, <span class="st">&quot;ancseq.nex&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb25-2"><a href="chapter1.html#cb25-2" aria-hidden="true"></a><span class="kw">read.hyphy.seq</span>(ancseq)</span></code></pre></div>
<pre><code>## 13 DNA sequences in binary format stored in a list.
## 
## All sequences of same length: 2148 
## 
## Labels:
## Node1
## Node2
## Node3
## Node4
## Node5
## Node12
## ...
## 
## Base composition:
##     a     c     g     t 
## 0.335 0.208 0.237 0.220 
## (Total: 27.92 kb)</code></pre>
<p>To map the sequences on the tree, user shall also provide an
internal-node-labelled tree. If users want to determine substitution, they need
also provide tip sequences.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter1.html#cb27-1" aria-hidden="true"></a>nwk &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/HYPHY&quot;</span>, <span class="st">&quot;labelledtree.tree&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb27-2"><a href="chapter1.html#cb27-2" aria-hidden="true"></a>tipfas &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pa.fas&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb27-3"><a href="chapter1.html#cb27-3" aria-hidden="true"></a>hy &lt;-<span class="st"> </span><span class="kw">read.hyphy</span>(nwk, ancseq, tipfas)</span>
<span id="cb27-4"><a href="chapter1.html#cb27-4" aria-hidden="true"></a>hy</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/HYPHY/labelledtree.tree&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
## 	K, N, D, L, J, G, ...
## Node labels:
## 	Node1, Node2, Node3, Node4, Node5, Node12, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;subs&#39;,	&#39;AA_subs&#39;.</code></pre>
</div>
<div id="parsing-r8s-output" class="section level4" number="1.3.2.6">
<h4><span class="header-section-number">1.3.2.6</span> Parsing r8s output</h4>
<p><a href="http://loco.biosci.arizona.edu/r8s/">r8s</a> uses parametric, semiparametric and
nonparametric methods to relax molecular clock to allow better estimations of
divergence times and evolution rates <span class="citation">(Sanderson <a href="#ref-sanderson_r8s:_2003" role="doc-biblioref">2003</a>)</span>. It outputs three
trees in log file, namely <em>TREE</em>, <em>RATO</em> and <em>PHYLO</em> for time tree, rate tree
and absolute substitution tree respectively.</p>
<p>Time tree is scaled by divergence time, rate tree is scaled by substitution rate
and absolute substitution tree is scaled by absolute number of substitution.
After parsing the file, all these three trees are stored in a <em>multiPhylo</em> object.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter1.html#cb29-1" aria-hidden="true"></a>r8s &lt;-<span class="st"> </span><span class="kw">read.r8s</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata/r8s&quot;</span>, <span class="st">&quot;H3_r8s_output.log&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>))</span>
<span id="cb29-2"><a href="chapter1.html#cb29-2" aria-hidden="true"></a>r8s</span></code></pre></div>
<pre><code>## 3 phylogenetic trees</code></pre>
</div>
<div id="parsing-output-of-raxml-bootstraping-analysis" class="section level4" number="1.3.2.7">
<h4><span class="header-section-number">1.3.2.7</span> Parsing output of RAxML bootstraping analysis</h4>
<p><a href="http://evomics.org/learning/phylogenetics/raxml/">RAxML</a> bootstraping analysis
output a Newick tree text that is not standard as it stores bootstrap values
inside square brackets after branch lengths. This file usually cannot be parsed
by traditional Newick parser, such as <code>ape::read.tree</code>. The function
<code>read.raxml</code> can read such file and stored the bootstrap as an additional
features, which can be used to display on the tree or used to color tree
branches, <em>etc.</em>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter1.html#cb31-1" aria-hidden="true"></a>raxml_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/RAxML&quot;</span>, <span class="st">&quot;RAxML_bipartitionsBranchLabels.H3&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb31-2"><a href="chapter1.html#cb31-2" aria-hidden="true"></a>raxml &lt;-<span class="st"> </span><span class="kw">read.raxml</span>(raxml_file)</span>
<span id="cb31-3"><a href="chapter1.html#cb31-3" aria-hidden="true"></a>raxml</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/RAxML/RAxML_bipartitionsBranchLabels.H3&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 64 tips and 62 internal nodes.
## 
## Tip labels:
## 	A_Hokkaido_M1_2014_H3N2_2014, A_Czech_Republic_1_2014_H3N2_2014, FJ532080_A_California_09_2008_H3N2_2008, EU199359_A_Pennsylvania_05_2007_H3N2_2007, EU857080_A_Hong_Kong_CUHK69904_2006_H3N2_2006, EU857082_A_Hong_Kong_CUHK7047_2005_H3N2_2005, ...
## 
## Unrooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;bootstrap&#39;.</code></pre>
</div>
<div id="parsing-nhx-tree" class="section level4" number="1.3.2.8">
<h4><span class="header-section-number">1.3.2.8</span> Parsing NHX tree</h4>
<p>NHX (New Hampshire eXtended) format is an extension of Newick by introducing NHX
tags. NHX is commonly used in phylogenetics software
(including
<a href="http://pbil.univ-lyon1.fr/software/phyldog/">PHYLDOG</a> <span class="citation">(Boussau et al. <a href="#ref-boussau_genome-scale_2013" role="doc-biblioref">2013</a>)</span>,
<a href="http://revbayes.github.io/intro.html">RevBayes</a> <span class="citation">(Höhna et al. <a href="#ref-hohna_probabilistic_2014" role="doc-biblioref">2014</a>)</span>)
for storing statistical inferences. The following codes imported a NHX tree with
associated data inferred by PHYLDOG.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter1.html#cb33-1" aria-hidden="true"></a>nhxfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/NHX&quot;</span>, <span class="st">&quot;phyldog.nhx&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb33-2"><a href="chapter1.html#cb33-2" aria-hidden="true"></a>nhx &lt;-<span class="st"> </span><span class="kw">read.nhx</span>(nhxfile)</span>
<span id="cb33-3"><a href="chapter1.html#cb33-3" aria-hidden="true"></a>nhx</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/NHX/phyldog.nhx&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 16 tips and 15 internal nodes.
## 
## Tip labels:
## 	Prayidae_D27SS7@2825365, Kephyes_ovata@2606431, Chuniphyes_multidentata@1277217, Apolemia_sp_@1353964, Bargmannia_amoena@263997, Bargmannia_elongata@946788, ...
## 
## Rooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;Ev&#39;,	&#39;S&#39;,	&#39;ND&#39;.</code></pre>
</div>
<div id="parsing-phylip-tree" class="section level4" number="1.3.2.9">
<h4><span class="header-section-number">1.3.2.9</span> Parsing Phylip tree</h4>
<p>Phylip format contains multiple sequence alignment of taxa in Phylip sequence
format with corresponding Newick tree text that was built from taxon sequences.
Multiple sequence alignment can be sorted based on the tree structure and displayed at
the right hand side of the tree using <a href="http://bioconductor.org/packages/ggtree">ggtree</a> (see also the <a href="chapter7.html#msaplot"><code>msaplot</code> function</a>).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapter1.html#cb35-1" aria-hidden="true"></a>phyfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;sample.phy&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb35-2"><a href="chapter1.html#cb35-2" aria-hidden="true"></a>phylip &lt;-<span class="st"> </span><span class="kw">read.phylip</span>(phyfile)</span>
<span id="cb35-3"><a href="chapter1.html#cb35-3" aria-hidden="true"></a>phylip</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/sample.phy&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
## 	K, N, D, L, J, G, ...
## 
## Unrooted; no branch lengths.</code></pre>
</div>
<div id="parsing-epa-and-pplacer-output" class="section level4" number="1.3.2.10">
<h4><span class="header-section-number">1.3.2.10</span> Parsing EPA and pplacer output</h4>
<p><a href="http://sco.h-its.org/exelixis/web/software/epa/index.html">EPA</a>
<span class="citation">(Berger, Krompass, and Stamatakis <a href="#ref-berger_EPA_2011" role="doc-biblioref">2011</a><a href="#ref-berger_EPA_2011" role="doc-biblioref">b</a>)</span> and <a href="http://matsen.fhcrc.org/pplacer/">PPLACER</a>
<span class="citation">(Frederick A Matsen, Kodner, and Armbrust <a href="#ref-matsen_pplacer_2010" role="doc-biblioref">2010</a>)</span> have common output file format, <code>jplace</code>, which can be
parsed by <code>read.jplace()</code> function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="chapter1.html#cb37-1" aria-hidden="true"></a>jpf &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/EPA.jplace&quot;</span>,  <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb37-2"><a href="chapter1.html#cb37-2" aria-hidden="true"></a>jp &lt;-<span class="st"> </span><span class="kw">read.jplace</span>(jpf)</span>
<span id="cb37-3"><a href="chapter1.html#cb37-3" aria-hidden="true"></a><span class="kw">print</span>(jp)</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/home/ygc/R/library/treeio/extdata/EPA.jplace&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 493 tips and 492 internal nodes.
## 
## Tip labels:
## 	CIR000447A, CIR000479, CIR000078, CIR000083, CIR000070, CIR000060, ...
## 
## Rooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;nplace&#39;.</code></pre>
<p>The number of evolutionary placement on each branch will be calculated and
stored as the <em>nplace</em> feature, which can be mapped to line size and/or color
using <a href="https://bioconductor.org/packages/ggtree/">ggtree</a> <span class="citation">(Yu et al. <a href="#ref-yu_ggtree:_2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<div id="jtree" class="section level4" number="1.3.2.11">
<h4><span class="header-section-number">1.3.2.11</span> Parsing jtree format</h4>
<p>The <em>jtree</em> is a JSON based format that was defined in
this <a href="https://bioconductor.org/packages/treeio/">treeio</a> package to support tree
data inter change (see <a href="chapter3.html#write-jtree">session 3.3</a>).
Phylogenetic tree with associated data can be exported to a single <em>jtree</em>
file using <code>write.jtree</code> function. The <em>jtree</em> can be easily parsed using any
JSON parser. The <em>jtree</em> format contains three keys: tree, data and metadata.
The tree value contains tree text extended from Newick tree format by putting
the edge number in curly braces after branch length. The data value contains
node/branch-specific data, while metadata value contains additional meta information.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="chapter1.html#cb39-1" aria-hidden="true"></a>jtree_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&#39;.jtree&#39;</span>)</span>
<span id="cb39-2"><a href="chapter1.html#cb39-2" aria-hidden="true"></a><span class="kw">write.jtree</span>(beast, <span class="dt">file =</span> jtree_file)</span>
<span id="cb39-3"><a href="chapter1.html#cb39-3" aria-hidden="true"></a><span class="kw">read.jtree</span>(<span class="dt">file =</span> jtree_file)</span></code></pre></div>
<pre><code>## &#39;treedata&#39; S4 object that stored information of
## 	&#39;/tmp/RtmpvGnYhp/file55a5554175e02.jtree&#39;.
## 
## ...@ phylo: 
## Phylogenetic tree with 15 tips and 14 internal nodes.
## 
## Tip labels:
## 	K_2013, N_2010, D_1987, L_1980, J_1983, G_1992, ...
## 
## Rooted; includes branch lengths.
## 
## with the following features available:
## 	&#39;height&#39;,	&#39;height_0.95_HPD&#39;,	&#39;height_range&#39;,	&#39;length&#39;,
## 	&#39;length_0.95_HPD&#39;,	&#39;length_median&#39;,	&#39;length_range&#39;,	&#39;rate&#39;,
## 	&#39;rate_0.95_HPD&#39;,	&#39;rate_median&#39;,	&#39;rate_range&#39;,
## 	&#39;height_median&#39;,	&#39;posterior&#39;.</code></pre>
</div>
</div>
<div id="as-treedata" class="section level3" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Converting other tree object to <code>treedata</code> object</h3>
<p><a href="http://bioconductor.org/packages/treeio">treeio</a> provides several <code>as.treedata</code> methods to convert other tree objects, such as <code>phylo4d</code> and <code>pml</code>, to <code>treedata</code> object, so that they can be easily manipulated and visualized using <a href="http://bioconductor.org/packages/treeio">treeio</a> and <a href="http://bioconductor.org/packages/ggtree">ggtree</a>.</p>
<p>The <code>pml</code> object defined in <a href="https://CRAN.R-project.org/package=phangorn">phangorn</a> package computes the likelihood of a phylogenetic tree given a sequence alignment and a model and the <code>optim.pml</code> optimizes different model parameters. It can be converted to a <code>treedata</code> object and amino acid substitution (ancestral sequence estimated by <code>pml</code>) can be visualized using <a href="http://bioconductor.org/packages/ggtree">ggtree</a> as demonstrated in Figure <a href="chapter1.html#fig:pmlTree">1.3</a>.</p>


<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="chapter1.html#cb41-1" aria-hidden="true"></a><span class="kw">library</span>(phangorn)</span>
<span id="cb41-2"><a href="chapter1.html#cb41-2" aria-hidden="true"></a>treefile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pa.nwk&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb41-3"><a href="chapter1.html#cb41-3" aria-hidden="true"></a>tre &lt;-<span class="st"> </span><span class="kw">read.tree</span>(treefile)</span>
<span id="cb41-4"><a href="chapter1.html#cb41-4" aria-hidden="true"></a>tipseqfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pa.fas&quot;</span>, <span class="dt">package=</span><span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb41-5"><a href="chapter1.html#cb41-5" aria-hidden="true"></a>tipseq &lt;-<span class="st"> </span><span class="kw">read.phyDat</span>(tipseqfile,<span class="dt">format=</span><span class="st">&quot;fasta&quot;</span>)</span>
<span id="cb41-6"><a href="chapter1.html#cb41-6" aria-hidden="true"></a>fit &lt;-<span class="st"> </span><span class="kw">pml</span>(tre, tipseq, <span class="dt">k=</span><span class="dv">4</span>)</span>
<span id="cb41-7"><a href="chapter1.html#cb41-7" aria-hidden="true"></a>fit &lt;-<span class="st"> </span><span class="kw">optim.pml</span>(fit, <span class="dt">optNni=</span><span class="ot">FALSE</span>, <span class="dt">optBf=</span>T, <span class="dt">optQ=</span>T,</span>
<span id="cb41-8"><a href="chapter1.html#cb41-8" aria-hidden="true"></a>                 <span class="dt">optInv=</span>T, <span class="dt">optGamma=</span>T, <span class="dt">optEdge=</span><span class="ot">TRUE</span>,</span>
<span id="cb41-9"><a href="chapter1.html#cb41-9" aria-hidden="true"></a>                 <span class="dt">optRooted=</span><span class="ot">FALSE</span>, <span class="dt">model =</span> <span class="st">&quot;GTR&quot;</span>,</span>
<span id="cb41-10"><a href="chapter1.html#cb41-10" aria-hidden="true"></a>				 <span class="dt">control =</span> <span class="kw">pml.control</span>(<span class="dt">trace =</span><span class="dv">0</span>))</span>
<span id="cb41-11"><a href="chapter1.html#cb41-11" aria-hidden="true"></a></span>
<span id="cb41-12"><a href="chapter1.html#cb41-12" aria-hidden="true"></a>pmltree &lt;-<span class="st"> </span><span class="kw">as.treedata</span>(fit)</span>
<span id="cb41-13"><a href="chapter1.html#cb41-13" aria-hidden="true"></a><span class="kw">ggtree</span>(pmltree) <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x=</span>branch, <span class="dt">label=</span>AA_subs, <span class="dt">vjust=</span><span class="op">-</span>.<span class="dv">5</span>))</span></code></pre></div>
<div class="figure"><span id="fig:pmlTree"></span>
<img src="treedata_files/figure-html/pmlTree-1.png" alt="Converting pml object to treedata object." width="1344" />
<p class="caption">
Figure 1.3: <strong>Converting <code>pml</code> object to <code>treedata</code> object.</strong>
</p>
</div>
</div>
<div id="get-treedata-data" class="section level3" number="1.3.4">
<h3><span class="header-section-number">1.3.4</span> Getting information from <code>treedata</code> object</h3>
<p>After the tree was imported, users may want to extract information that stored
in the <code>treedata</code> object. <a href="http://bioconductor.org/packages/treeio">treeio</a> provides several accessor
methods to extract tree structure, features/attributes that stored in the object
and their corresponding values.</p>
<p>The <code>get.tree</code> or <code>as.phylo</code> methods can convert the <code>treedata</code> object to
<code>phylo</code> object which is the fundamental tree object in the R community and
many packages work with <code>phylo</code> object.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapter1.html#cb42-1" aria-hidden="true"></a>beast_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;examples/MCC_FluA_H3.tree&quot;</span>, <span class="dt">package=</span><span class="st">&quot;ggtree&quot;</span>)</span>
<span id="cb42-2"><a href="chapter1.html#cb42-2" aria-hidden="true"></a>beast_tree &lt;-<span class="st"> </span><span class="kw">read.beast</span>(beast_file)</span>
<span id="cb42-3"><a href="chapter1.html#cb42-3" aria-hidden="true"></a><span class="co"># or get.tree</span></span>
<span id="cb42-4"><a href="chapter1.html#cb42-4" aria-hidden="true"></a><span class="kw">as.phylo</span>(beast_tree)</span></code></pre></div>
<pre><code>## 
## Phylogenetic tree with 76 tips and 75 internal nodes.
## 
## Tip labels:
## 	A/Hokkaido/30-1-a/2013, A/New_York/334/2004, A/New_York/463/2005, A/New_York/452/1999, A/New_York/238/2005, A/New_York/523/1998, ...
## 
## Rooted; includes branch lengths.</code></pre>
<p>The <code>get.fields</code> method return a vector of features/attributes that stored in
the object and associated with the phylogeny.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapter1.html#cb44-1" aria-hidden="true"></a><span class="kw">get.fields</span>(beast_tree)</span></code></pre></div>
<pre><code>##  [1] &quot;height&quot;          &quot;height_0.95_HPD&quot; &quot;height_median&quot;  
##  [4] &quot;height_range&quot;    &quot;length&quot;          &quot;length_0.95_HPD&quot;
##  [7] &quot;length_median&quot;   &quot;length_range&quot;    &quot;posterior&quot;      
## [10] &quot;rate&quot;            &quot;rate_0.95_HPD&quot;   &quot;rate_median&quot;    
## [13] &quot;rate_range&quot;</code></pre>
<p>The <code>get.data</code> method return a tibble of all the associated data.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapter1.html#cb46-1" aria-hidden="true"></a><span class="kw">get.data</span>(beast_tree)</span></code></pre></div>
<pre><code>## # A tibble: 151 x 14
##    height height_0.95_HPD height_median height_range length
##     &lt;dbl&gt; &lt;list&gt;                  &lt;dbl&gt; &lt;list&gt;        &lt;dbl&gt;
##  1   19   &lt;dbl [2]&gt;                19   &lt;dbl [2]&gt;     2.34 
##  2   17   &lt;dbl [2]&gt;                17   &lt;dbl [2]&gt;     1.18 
##  3   14   &lt;dbl [2]&gt;                14   &lt;dbl [2]&gt;     0.966
##  4   12   &lt;dbl [2]&gt;                12   &lt;dbl [2]&gt;     1.87 
##  5    9   &lt;dbl [2]&gt;                 9   &lt;dbl [2]&gt;     2.93 
##  6   10   &lt;dbl [2]&gt;                10   &lt;dbl [2]&gt;     0.827
##  7   10   &lt;dbl [2]&gt;                10   &lt;dbl [2]&gt;     0.834
##  8   10.8 &lt;dbl [2]&gt;                10.8 &lt;dbl [2]&gt;     0.233
##  9    9   &lt;dbl [2]&gt;                 9   &lt;dbl [2]&gt;     1.28 
## 10    9   &lt;dbl [2]&gt;                 9   &lt;dbl [2]&gt;     0.414
## # … with 141 more rows, and 9 more variables:
## #   length_0.95_HPD &lt;list&gt;, length_median &lt;dbl&gt;,
## #   length_range &lt;list&gt;, posterior &lt;dbl&gt;, rate &lt;dbl&gt;,
## #   rate_0.95_HPD &lt;list&gt;, rate_median &lt;dbl&gt;,
## #   rate_range &lt;list&gt;, node &lt;int&gt;</code></pre>
<p>If users are only interesting a subset of the features/attributes return by
<code>get.fields</code>, they can extract the information from the output of <code>get.data</code> or
directly subset the data by <code>[</code> or <code>[[</code>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="chapter1.html#cb48-1" aria-hidden="true"></a>beast_tree[, <span class="kw">c</span>(<span class="st">&quot;node&quot;</span>, <span class="st">&quot;height&quot;</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 151 x 2
##     node height
##    &lt;int&gt;  &lt;dbl&gt;
##  1    10   19  
##  2     9   17  
##  3    36   14  
##  4    31   12  
##  5    29    9  
##  6    28   10  
##  7    39   10  
##  8    90   10.8
##  9    16    9  
## 10     2    9  
## # … with 141 more rows</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapter1.html#cb50-1" aria-hidden="true"></a><span class="kw">head</span>(beast_tree[[<span class="st">&quot;height_median&quot;</span>]])</span></code></pre></div>
<pre><code>## height_median1 height_median2 height_median3 height_median4 
##             19             17             14             12 
## height_median5 height_median6 
##              9             10</code></pre>
</div>
</div>
<div id="summary" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Summary</h2>
<p>Software tools for inferring molecular evolution (<em>e.g.</em>, ancestral states, molecular dating and selection pressure, <em>etc.</em>) are proliferating, but there is no single data format that is used by all different programs and capable to store different types of phylogenetic data. Most of the software packages have their own unique output formats and these formats are not compatible with each other. Parsing software outputs is challenging, which restricts the joint analysis using different tools. The <a href="http://bioconductor.org/packages/treeio">treeio</a> provides a set of functions (Table <a href="chapter1.html#tab:treeio-function">1.1</a>) for parsing various types of phylogenetic data files. These phylogenetic data can be integrated together that allows further exploration and comparison. Until now, most software tools in field of molecular evolution are isolated and often not fully compatible with each other for input and output files. All these software tools are designed to do their own analysis and the outputs are often not readable in other software. There is no software tool that was particularly designed to unify the inference data from different analysis programs. An efficient incorporation of the different inference data can compare and verify between methods, and comprehend the understanding of the study target at different aspects and angles, which may discover new systematic patterns and bring new insights to generate new hypothesis.</p>
<p>As phylogenetic trees are growing in its application to identify patterns in evolutionary context, more different disciplines are employing phylogenetic trees in their research. For example, spatial ecologists may map the geographical positions of the organisms to their phylogenetic trees to understand the biogeography of the species <span class="citation">(Schön et al. <a href="#ref-schon_age_2015" role="doc-biblioref">2015</a>)</span>; disease epidemiologists may incorporate the pathogen sampling time and locations into the phylogenetic analysis to infer the disease transmission dynamics in spatiotemporal space <span class="citation">(He et al. <a href="#ref-he_emergence_2013" role="doc-biblioref">2013</a>)</span>; microbiologists may determine the pathogenicity of different pathogen strains and map them into their phylogenetic trees to identify the genetic determinants of the pathogenicity <span class="citation">(Bosi et al. <a href="#ref-bosi_comparative_2016" role="doc-biblioref">2016</a>)</span>; genomic scientists may use the phylogenetic trees to help taxonomically classify their metagenomic sequence data <span class="citation">(Gupta and Sharma <a href="#ref-gupta_using_2015" role="doc-biblioref">2015</a>)</span>. A robust tool such as <a href="http://bioconductor.org/packages/treeio">treeio</a> to import and map different types of data into the phylogenetic tree is important to facilitate these phylogenetics-related research, or <em>a.k.a</em> ‘phylodynamics’. Such tool could also help integrate different metadata (time, geography, genotype, epidemiological information) and analysis results (selective pressure, evolutionary rates) at the highest level and provide a comprehensive understanding of the study organisms. In the field of influenza research, there have been such attemps of studying phylodynamics of the influenza virus by mapping different meta-data and analysis results on the same phylogenetic tree and evolutionary time scale <span class="citation">(Lam et al. <a href="#ref-lam_dissemination_2015" role="doc-biblioref">2015</a>)</span>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-arenas_trends_2015">
<p>Arenas, Miguel. 2015. “Trends in Substitution Models of Molecular Evolution.” <em>Frontiers in Genetics</em> 6 (October). <a href="https://doi.org/10.3389/fgene.2015.00319">https://doi.org/10.3389/fgene.2015.00319</a>.</p>
</div>
<div id="ref-berger_performance_2011">
<p>Berger, Simon A., Denis Krompass, and Alexandros Stamatakis. 2011a. “Performance, Accuracy, and Web Server for Evolutionary Placement of Short Sequence Reads Under Maximum Likelihood.” <em>Systematic Biology</em>, March, syr010. <a href="https://doi.org/10.1093/sysbio/syr010">https://doi.org/10.1093/sysbio/syr010</a>.</p>
</div>
<div id="ref-berger_EPA_2011">
<p>Berger, Simon A., Denis Krompass, and Alexandros Stamatakis. 2011a. “Performance, Accuracy, and Web Server for Evolutionary Placement of Short Sequence Reads Under Maximum Likelihood.” <em>Systematic Biology</em>, March, syr010. <a href="https://doi.org/10.1093/sysbio/syr010">https://doi.org/10.1093/sysbio/syr010</a>.</p> 2011b. “Performance, Accuracy, and Web Server for Evolutionary Placement of Short Sequence Reads Under Maximum Likelihood.” <em>Systematic Biology</em> 60 (3): 291–302. <a href="https://doi.org/10.1093/sysbio/syr010">https://doi.org/10.1093/sysbio/syr010</a>.</p>
</div>
<div id="ref-bosi_comparative_2016">
<p>Bosi, Emanuele, Jonathan M. Monk, Ramy K. Aziz, Marco Fondi, Victor Nizet, and Bernhard Ø. Palsson. 2016. “Comparative Genome-Scale Modelling of Staphylococcus Aureus Strains Identifies Strain-Specific Metabolic Capabilities Linked to Pathogenicity.” <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113 (26): E3801–E3809. <a href="https://doi.org/10.1073/pnas.1523199113">https://doi.org/10.1073/pnas.1523199113</a>.</p>
</div>
<div id="ref-bouckaert_beast_2014">
<p>Bouckaert, Remco, Joseph Heled, Denise Kühnert, Tim Vaughan, Chieh-Hsi Wu, Dong Xie, Marc A. Suchard, Andrew Rambaut, and Alexei J. Drummond. 2014. “BEAST 2: A Software Platform for Bayesian Evolutionary Analysis.” <em>PLoS Comput Biol</em> 10 (4): e1003537. <a href="https://doi.org/10.1371/journal.pcbi.1003537">https://doi.org/10.1371/journal.pcbi.1003537</a>.</p>
</div>
<div id="ref-boussau_genome-scale_2013">
<p>Boussau, Bastien, Gergely J. Szöllősi, Laurent Duret, Manolo Gouy, Eric Tannier, and Vincent Daubin. 2013. “Genome-Scale Coestimation of Species and Gene Trees.” <em>Genome Research</em> 23 (2): 323–30. <a href="https://doi.org/10.1101/gr.141978.112">https://doi.org/10.1101/gr.141978.112</a>.</p>
</div>
<div id="ref-felsenstein_evolutionary_1981">
<p>Felsenstein, J. 1981. “Evolutionary Trees from DNA Sequences: A Maximum Likelihood Approach.” <em>Journal of Molecular Evolution</em> 17 (6): 368–76.</p>
</div>
<div id="ref-felsenstein_phylip_1989">
<p>Felsenstein, Joseph. 1989. “PHYLIP - Phylogeny Inference Package (Version 3.2).” <em>Cladistics</em> 5: 164–66.</p>
</div>
<div id="ref-felsenstein_cases_1978">
<p>Felsenstein, Joseph. 1978. “Cases in Which Parsimony or Compatibility Methods Will Be Positively Misleading.” <em>Systematic Biology</em> 27 (4): 401–10. <a href="https://doi.org/10.1093/sysbio/27.4.401">https://doi.org/10.1093/sysbio/27.4.401</a>.</p>
</div>
<div id="ref-fitch_toward_1971">
<p>Fitch, Walter M. 1971. “Toward Defining the Course of Evolution: Minimum Change for a Specific Tree Topology.” <em>Systematic Zoology</em> 20 (4): 406–16. <a href="https://doi.org/10.2307/2412116">https://doi.org/10.2307/2412116</a>.</p>
</div>
<div id="ref-goldman_codon-based_1994">
<p>Goldman, N., and Z. Yang. 1994. “A Codon-Based Model of Nucleotide Substitution for Protein-Coding DNA Sequences.” <em>Molecular Biology and Evolution</em> 11 (5): 725–36.</p>
</div>
<div id="ref-gupta_using_2015">
<p>Gupta, Ankit, and Vineet K Sharma. 2015. “Using the Taxon-Specific Genes for the Taxonomic Classification of Bacterial Genomes.” <em>BMC Genomics</em> 16 (1). <a href="https://doi.org/10.1186/s12864-015-1542-0">https://doi.org/10.1186/s12864-015-1542-0</a>.</p>
</div>
<div id="ref-he_emergence_2013">
<p>He, Ya-Qing, Long Chen, Wen-Bo Xu, Hong Yang, Han-Zhong Wang, Wen-Ping Zong, Hui-Xia Xian, et al. 2013. “Emergence, Circulation, and Spatiotemporal Phylogenetic Analysis of Coxsackievirus A6- and Coxsackievirus A10-Associated Hand, Foot, and Mouth Disease Infections from 2008 to 2012 in Shenzhen, China.” <em>Journal of Clinical Microbiology</em> 51 (11): 3560–6. <a href="https://doi.org/10.1128/JCM.01231-13">https://doi.org/10.1128/JCM.01231-13</a>.</p>
</div>
<div id="ref-hohna_probabilistic_2014">
<p>Höhna, Sebastian, Tracy A. Heath, Bastien Boussau, Michael J. Landis, Fredrik Ronquist, and John P. Huelsenbeck. 2014. “Probabilistic Graphical Model Representation in Phylogenetics.” <em>Systematic Biology</em> 63 (5): 753–71. <a href="https://doi.org/10.1093/sysbio/syu039">https://doi.org/10.1093/sysbio/syu039</a>.</p>
</div>
<div id="ref-hohna_revbayes:_2016">
<p>Höhna, Sebastian, Michael J. Landis, Tracy A. Heath, Bastien Boussau, Nicolas Lartillot, Brian R. Moore, John P. Huelsenbeck, and Fredrik Ronquist. 2016. “RevBayes: Bayesian Phylogenetic Inference Using Graphical Models and an Interactive Model-Specification Language.” <em>Systematic Biology</em> 65 (4): 726–36. <a href="https://doi.org/10.1093/sysbio/syw021">https://doi.org/10.1093/sysbio/syw021</a>.</p>
</div>
<div id="ref-huelsenbeck_mrbayes_2001">
<p>Huelsenbeck, J. P., and F. Ronquist. 2001. “MRBAYES: Bayesian Inference of Phylogenetic Trees.” <em>Bioinformatics (Oxford, England)</em> 17 (8): 754–55.</p>
</div>
<div id="ref-kumar_mega7_2016">
<p>Kumar, Sudhir, Glen Stecher, and Koichiro Tamura. 2016. “MEGA7: Molecular Evolutionary Genetics Analysis Version 7.0 for Bigger Datasets.” <em>Molecular Biology and Evolution</em> 33 (7): 1870–4. <a href="https://doi.org/10.1093/molbev/msw054">https://doi.org/10.1093/molbev/msw054</a>.</p>
</div>
<div id="ref-lam_dissemination_2015">
<p>Lam, Tommy Tsan-Yuk, Boping Zhou, Jia Wang, Yujuan Chai, Yongyi Shen, Xinchun Chen, Chi Ma, et al. 2015. “Dissemination, Divergence and Establishment of H7N9 Influenza Viruses in China.” <em>Nature</em> 522 (7554): 102–5. <a href="https://doi.org/10.1038/nature14348">https://doi.org/10.1038/nature14348</a>.</p>
</div>
<div id="ref-lemmon_importance_2004">
<p>Lemmon, Alan R., and Emily C. Moriarty. 2004. “The Importance of Proper Model Assumption in Bayesian Phylogenetics.” <em>Systematic Biology</em> 53 (2): 265–77. <a href="https://doi.org/10.1080/10635150490423520">https://doi.org/10.1080/10635150490423520</a>.</p>
</div>
<div id="ref-maddison_nexus:_1997">
<p>Maddison, David R., David L. Swofford, Wayne P. Maddison, and David Cannatella. 1997. “Nexus: An Extensible File Format for Systematic Information.” <em>Systematic Biology</em> 46 (4): 590–621. <a href="https://doi.org/10.1093/sysbio/46.4.590">https://doi.org/10.1093/sysbio/46.4.590</a>.</p>
</div>
<div id="ref-matsen_format_2012">
<p>Matsen, Frederick A., Noah G. Hoffman, Aaron Gallagher, and Alexandros Stamatakis. 2012. “A Format for Phylogenetic Placements.” <em>PLoS ONE</em> 7 (2): e31009. <a href="https://doi.org/10.1371/journal.pone.0031009">https://doi.org/10.1371/journal.pone.0031009</a>.</p>
</div>
<div id="ref-matsen_pplacer:_2010">
<p>Matsen, Frederick A., Robin B. Kodner, and E Virginia Armbrust. 2010. “Pplacer: Linear Time Maximum-Likelihood and Bayesian Phylogenetic Placement of Sequences onto a Fixed Reference Tree.” <em>BMC Bioinformatics</em> 11: 538. <a href="https://doi.org/10.1186/1471-2105-11-538">https://doi.org/10.1186/1471-2105-11-538</a>.</p>
</div>
<div id="ref-matsen_pplacer_2010">
<p>Matsen, Frederick A, Robin B Kodner, and E Virginia Armbrust. 2010. “Pplacer: Linear Time Maximum-Likelihood and Bayesian Phylogenetic Placement of Sequences onto a Fixed Reference Tree.” <em>BMC Bioinformatics</em> 11 (1): 538. <a href="https://doi.org/10.1186/1471-2105-11-538">https://doi.org/10.1186/1471-2105-11-538</a>.</p>
</div>
<div id="ref-paradis_ape_2004">
<p>Paradis, Emmanuel, Julien Claude, and Korbinian Strimmer. 2004. “APE: Analyses of Phylogenetics and Evolution in R Language.” <em>Bioinformatics</em> 20 (2): 289–90. <a href="https://doi.org/10.1093/bioinformatics/btg412">https://doi.org/10.1093/bioinformatics/btg412</a>.</p>
</div>
<div id="ref-pond_hyphy:_2005">
<p>Pond, Sergei L. Kosakovsky, Simon D. W. Frost, and Spencer V. Muse. 2005. “HyPhy: Hypothesis Testing Using Phylogenies.” <em>Bioinformatics (Oxford, England)</em> 21 (5): 676–79. <a href="https://doi.org/10.1093/bioinformatics/bti079">https://doi.org/10.1093/bioinformatics/bti079</a>.</p>
</div>
<div id="ref-rannala_probability_1996">
<p>Rannala, B., and Z. Yang. 1996. “Probability Distribution of Molecular Evolutionary Trees: A New Method of Phylogenetic Inference.” <em>Journal of Molecular Evolution</em> 43 (3): 304–11.</p>
</div>
<div id="ref-rstats">
<p>R Core Team. 2016. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-retief_phylogenetic_2000">
<p>Retief, J. D. 2000. “Phylogenetic Analysis Using PHYLIP.” <em>Methods in Molecular Biology (Clifton, N.J.)</em> 132: 243–58.</p>
</div>
<div id="ref-sanderson_r8s:_2003">
<p>Sanderson, Michael J. 2003. “R8s: Inferring Absolute Rates of Molecular Evolution and Divergence Times in the Absence of a Molecular Clock.” <em>Bioinformatics</em> 19 (2): 301–2. <a href="https://doi.org/10.1093/bioinformatics/19.2.301">https://doi.org/10.1093/bioinformatics/19.2.301</a>.</p>
</div>
<div id="ref-schliep_phangorn_2011">
<p>Schliep, Klaus Peter. 2011. “Phangorn: Phylogenetic Analysis in R.” <em>Bioinformatics</em> 27 (4): 592–93. <a href="https://doi.org/10.1093/bioinformatics/btq706">https://doi.org/10.1093/bioinformatics/btq706</a>.</p>
</div>
<div id="ref-schmidt_tree-puzzle:_2002">
<p>Schmidt, Heiko A., Korbinian Strimmer, Martin Vingron, and Arndt von Haeseler. 2002. “TREE-PUZZLE: Maximum Likelihood Phylogenetic Analysis Using Quartets and Parallel Computing.” <em>Bioinformatics (Oxford, England)</em> 18 (3): 502–4.</p>
</div>
<div id="ref-schon_age_2015">
<p>Schön, Isa, Rylan Shearn, Koen Martens, Annette Koenders, and Stuart Halse. 2015. “Age and Origin of Australian Bennelongia (Crustacea, Ostracoda).” <em>Hydrobiologia</em> 750 (1): 125–46. <a href="https://doi.org/10.1007/s10750-014-2159-z">https://doi.org/10.1007/s10750-014-2159-z</a>.</p>
</div>
<div id="ref-shoemaker_evidence_1989">
<p>Shoemaker, J. S., and W. M. Fitch. 1989. “Evidence from Nuclear Sequences That Invariable Sites Should Be Considered When Sequence Divergence Is Calculated.” <em>Molecular Biology and Evolution</em> 6 (3): 270–89.</p>
</div>
<div id="ref-stamatakis_raxml_2014">
<p>Stamatakis, Alexandros. 2014. “RAxML Version 8: A Tool for Phylogenetic Analysis and Post-Analysis of Large Phylogenies.” <em>Bioinformatics</em>, January, btu033. <a href="https://doi.org/10.1093/bioinformatics/btu033">https://doi.org/10.1093/bioinformatics/btu033</a>.</p>
</div>
<div id="ref-wilgenbusch_inferring_2003">
<p>Wilgenbusch, James C., and David Swofford. 2003. “Inferring Evolutionary Trees with PAUP*.” <em>Current Protocols in Bioinformatics</em> Chapter 6 (February): Unit 6.4. <a href="https://doi.org/10.1002/0471250953.bi0604s00">https://doi.org/10.1002/0471250953.bi0604s00</a>.</p>
</div>
<div id="ref-yang_maximum_1994">
<p>Yang, Z. 1994. “Maximum Likelihood Phylogenetic Estimation from DNA Sequences with Variable Rates over Sites: Approximate Methods.” <em>Journal of Molecular Evolution</em> 39 (3): 306–14.</p>
</div>
<div id="ref-yang_paml_2007">
<p>Yang, Ziheng. 2007. “PAML 4: Phylogenetic Analysis by Maximum Likelihood.” <em>Molecular Biology and Evolution</em> 24 (8): 1586–91. <a href="https://doi.org/10.1093/molbev/msm088">https://doi.org/10.1093/molbev/msm088</a>.</p>
</div>
<div id="ref-yu_ggtree:_2017">
<p>Yu, Guangchuang, David K. Smith, Huachen Zhu, Yi Guan, and Tommy Tsan-Yuk Lam. 2017. “Ggtree: An R Package for Visualization and Annotation of Phylogenetic Trees with Their Covariates and Other Associated Data.” <em>Methods in Ecology and Evolution</em> 8 (1): 28–36. <a href="https://doi.org/10.1111/2041-210X.12628">https://doi.org/10.1111/2041-210X.12628</a>.</p>
</div>
<div id="ref-zmasek_atv:_2001">
<p>Zmasek, Christian M., and Sean R. Eddy. 2001. “ATV: Display and Manipulation of Annotated Phylogenetic Trees.” <em>Bioinformatics</em> 17 (4): 383–84. <a href="https://doi.org/10.1093/bioinformatics/17.4.383">https://doi.org/10.1093/bioinformatics/17.4.383</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="http://evolution.genetics.washington.edu/phylip/newick_doc.html" class="uri">http://evolution.genetics.washington.edu/phylip/newick_doc.html</a><a href="chapter1.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="http://www.genetics.wustl.edu/eddy/forester/NHX.html" class="uri">http://www.genetics.wustl.edu/eddy/forester/NHX.html</a><a href="chapter1.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><a href="https://sites.google.com/site/cmzmasek/home/software/archaeopteryx" class="uri">https://sites.google.com/site/cmzmasek/home/software/archaeopteryx</a><a href="chapter1.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p><a href="http://biopython.org/wiki/PAML" class="uri">http://biopython.org/wiki/PAML</a><a href="chapter1.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p><a href="http://bioperl.org/howtos/PAML_HOWTO.html" class="uri">http://bioperl.org/howtos/PAML_HOWTO.html</a><a href="chapter1.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><a href="https://github.com/ropensci/software-review/issues/179#issuecomment-369164110" class="uri">https://github.com/ropensci/software-review/issues/179#issuecomment-369164110</a><a href="chapter1.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>users can also use <code>read.tree</code> and <code>read.nexus</code> from <a href="https://CRAN.R-project.org/package=ape">ape</a> to import phylogenetic tree from newick string and NEXUS file<a href="chapter1.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["treedata.pdf", "treedata.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
