[
["index.html", "Data Integration, Manipulation and Visualization of Phylogenetic Trees Preface", " Data Integration, Manipulation and Visualization of Phylogenetic Trees Guangchuang Yu Preface hello "],
["importing-tree-with-data.html", "Chapter 1 Importing tree with data", " Chapter 1 Importing tree with data hello world. "],
["manipulating-tree-with-data.html", "Chapter 2 Manipulating tree with data", " Chapter 2 Manipulating tree with data treeio + tidytree "],
["exporting-tree-with-data.html", "Chapter 3 Exporting tree with data", " Chapter 3 Exporting tree with data "],
["phylogenetic-tree-visualization.html", "Chapter 4 Phylogenetic Tree Visualization", " Chapter 4 Phylogenetic Tree Visualization "],
["phylogenetic-tree-annotation.html", "Chapter 5 Phylogenetic Tree Annotation", " Chapter 5 Phylogenetic Tree Annotation "],
["visual-exploration-of-phylogenetic-tree.html", "Chapter 6 Visual Exploration of Phylogenetic Tree", " Chapter 6 Visual Exploration of Phylogenetic Tree "],
["plotting-tree-with-data.html", "Chapter 7 Plotting tree with data", " Chapter 7 Plotting tree with data "],
["annotating-tree-with-silhouette-images-and-sub-plots.html", "Chapter 8 Annotating Tree with Silhouette Images and Sub-plots 8.1 Annotating Tree with Images 8.2 Annotating Tree with Phylopic 8.3 Annotating Tree with Sub-plots 8.4 Have Fun with Phylomoji", " Chapter 8 Annotating Tree with Silhouette Images and Sub-plots 8.1 Annotating Tree with Images We usually use text to label taxa, i.e. displaying taxa names. If the text is image file name (either local or remote), ggtree can read the image and display the actual image as label of the taxa. The geom_tiplab and geom_nodelab are capable to render silhouette image by internally called ggimage package. library(ggimage) library(ggtree) nwk &lt;- &quot;((((bufonidae, dendrobatidae), ceratophryidae), (centrolenidae, leptodactylidae)), hylidae);&quot; x = read.tree(text = nwk) ggtree(x) + xlim(NA, 7) + ylim(NA, 6.2) + geom_tiplab(aes(image=paste0(&quot;img/frogs/&quot;, label, &#39;.jpg&#39;)), geom=&quot;image&quot;, offset=2, align=2, size=.2) + geom_tiplab(geom=&#39;label&#39;, offset=1, hjust=.5) + geom_image(x=.8, y=5.5, image=&quot;img/frogs/frog.jpg&quot;, size=.2) 8.2 Annotating Tree with Phylopic Phylopic contains more than 3200 silhouettes and covers almost all life forms. ggtree also supports using phylopic to annotate the tree. Most importantly, we can color the image using numerical/categorical variable. tree &lt;- ape::read.nexus(&quot;https://raw.githubusercontent.com/rgriff23/Dissertation/master/Chapter_2/data/tree.nex&quot;) phylopic_info &lt;- data.frame(node = c(124, 113, 110, 96, 89, 70), phylopic = c(&quot;7fb9bea8-e758-4986-afb2-95a2c3bf983d&quot;, &quot;bac25f49-97a4-4aec-beb6-f542158ebd23&quot;, &quot;f598fb39-facf-43ea-a576-1861304b2fe4&quot;, &quot;aceb287d-84cf-46f1-868c-4797c4ac54a8&quot;, &quot;0174801d-15a6-4668-bfe0-4c421fbe51e8&quot;, &quot;72f2f854-f3cd-4666-887c-35d5c256ab0f&quot;), species = c(&quot;galagoids&quot;, &quot;lemurs&quot;, &quot;tarsiers&quot;, &quot;cebids&quot;, &quot;hominoids&quot;, &quot;cercopithecoids&quot;)) pg &lt;- ggtree(tree) pg %&lt;+% phylopic_info + geom_nodelab(aes(image=phylopic, color=species, subset=!is.na(species)), geom=&quot;phylopic&quot;) + theme(legend.position=c(.1, .8)) 8.3 Annotating Tree with Sub-plots 8.4 Have Fun with Phylomoji #phylomoji is fun and it is internally supported by ggtree. Here, we will use ggtree to recreate the figure: library(ggplot2) library(ggtree) tt = &#39;((snail,mushroom),(((sunflower,evergreen_tree),leaves),green_salad));&#39; tree = read.tree(text = tt) d &lt;- data.frame(label = c(&#39;snail&#39;,&#39;mushroom&#39;, &#39;sunflower&#39;, &#39;evergreen_tree&#39;,&#39;leaves&#39;, &#39;green_salad&#39;), group = c(&#39;animal&#39;, &#39;fungi&#39;, &#39;flowering plant&#39;, &#39;conifers&#39;, &#39;ferns&#39;, &#39;mosses&#39;)) ggtree(tree, linetype = &quot;dashed&quot;, size=1, color=&#39;firebrick&#39;) %&lt;+% d + xlim(0, 4.5) + ylim(0.5, 6.5) + geom_tiplab(aes(color=label), parse=&quot;emoji&quot;, size=15, vjust=.25) + geom_tiplab(aes(label = group), geom=&quot;label&quot;, x=3.5, hjust=.5) With ggtree, it is easy to generate phylomoji. The emoji is treated as text, like abc. We can use emojis to label taxa, clade, color and ratate emoji with any given color and angle. 8.4.1 emoji in cirular layout tree ggtree(tree, layout = &quot;circular&quot;, size=1) + geom_tiplab2(aes(color=label), parse=&quot;emoji&quot;, size=15, vjust=.25) 8.4.2 emoji to label clades set.seed(123) tr &lt;- rtree(30) ggtree(tr) + xlim(NA, 5) + geom_cladelabel(node=41, label=&quot;chicken&quot;, parse=&quot;emoji&quot;, fontsize=12, align=TRUE, color=&quot;firebrick&quot;) + geom_cladelabel(node=51, label=&quot;duck&quot;, parse=&quot;emoji&quot;, fontsize=12, align=TRUE, color=&quot;steelblue&quot;) + geom_cladelabel(node=32, label=&quot;family&quot;, parse=&quot;emoji&quot;, fontsize=12, align=TRUE, color=&quot;darkkhaki&quot;) "],
["references.html", "References", " References "]
]
